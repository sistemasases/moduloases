define(["jquery","block_ases/bootstrap","block_ases/sweetalert","block_ases/jqueryui"],function(e,r,t,o){return{init:function(){function r(e){var r=!1,t=e.val();return t>5||0>t?(swal({title:"Ingrese un valor valido, entre 0 y 5. \n\rUsted ingresó: "+t,html:!0,type:"warning",confirmButtonColor:"#d51b23"}),e.val(c),r=!1):""==t&&""!=c?(e.val("0"),r=!0):r=""==t&&""==c||t==c?!1:!0,r}function t(){e(".cat").each(function(){var r=e(this).children().next(".text");r.attr("disabled",!0),r.css("font-weight","bold")}),e(".course").each(function(){var r=e(this).children().next(".text");r.attr("disabled",!0),r.css("font-weight","bold"),r.css("font-size",16)}),e(".header").children().each(function(){e(this).removeAttr("href")})}function o(r){e("#user-grades").children().children().each(function(){void 0!=e(this).attr("data-uid")&&(a(e(this).attr("data-uid"),r)?e(this).children("th").children().each(function(){e(this).removeAttr("href"),e(this).click(function(){var r=e(this).parent().parent().attr("data-uid"),t=e("#idmoodle_"+r).attr("data-code"),o="student_profile.php";o+location.search+"&student_code="+t})}):e(this).remove())})}function a(e,r){for(var t=0;t<r.length;t++)if(r[t].split("_")[1]===e)return!0;return!1}function n(){var r=new Array;return e("#students-pilos").children().each(function(){r.push(e(this).attr("id"))}),r}function i(){for(var e=window.location.search.split("&"),r=0;r<e.length;r++){var t=e[r].split("=");if("?id_course"==t[0]||"id_course"==t[0])var o=t[1]}return o}var c;e(document).ready(function(){var r=n();o(r),t(),0!=e(".gradingerror").length&&(new_page=location.origin+"/moodle/grade/report/grader/index.php?id="+i(),swal({title:"Redireccionando página.",text:"Debido al proceso de actualización del campus virtual se debe realizar este paso.\nSOLO EL DOCENTE ENCARGADO DEL CURSO PUEDE \n Una vez realizado por favor cerrar la ventana y volver a seleccionar su curso en el listado",type:"warning",showCancelButton:!1,confirmButtonClass:"btn-danger",confirmButtonText:"Continuar",closeOnConfirm:!1},function(){location.href=new_page}))}),e(document).on("blur",".text",function(){if(r(e(this))){var t=e(this).attr("id").split("_"),o=t[1],a=t[2],n=e(this).val(),c=i(),l={user:o,item:a,finalgrade:n,course:c};e.ajax({type:"POST",data:l,url:"../managers/grade_categories/grader_processing.php",async:!1,success:function(e){var r=e.nota;if(1==r){if(console.log("Nota actualizada"),3>n){var t=e.monitor,o=e.practicante,a=e.profesional;1==t?console.log("mensaje al monitor enviado correctamente"):(console.log("error monitor"),swal("Error","Error al enviar correo al monitor","error")),1==o?console.log("mensaje al practicante enviado correctamente"):(console.log("error practicante"),swal("Error","Error al enviar correo al practicante","error")),1==a?console.log("mensaje al profesional enviado correctamente"):(console.log("error profesional"),swal("Error","Error al enviar correo al profesional","error"))}}else swal("Error","Error al actualizar la nota","error")},dataType:"json",cache:"false",error:function(e){console.log(e)}})}}),e(document).on("focus",".text",function(){c=e(this).val()}),e(document).on("keypress",".text",function(e){return tecla=document.all?e.keyCode:e.which,8==tecla||46==tecla?!0:(patron=/[0-9]/,tecla_final=String.fromCharCode(tecla),patron.test(tecla_final))}),e(document).on("click",".reload",function(){location.reload()})}}});