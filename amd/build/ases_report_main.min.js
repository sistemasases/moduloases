'use strict';define(['jquery','block_ases/datatables.net','block_ases/buttons.flash','block_ases/jszip','block_ases/bootstrap','block_ases/sweetalert','block_ases/buttons.html5','block_ases/buttons.print','block_ases/jqueryui'],function(a){function b(){var e=a('#form_general_report').serializeArray();e.push({name:'instance_id',value:d()}),a('#not_assigned_students').html('<img class="icon-loading" src="../icon/loading.gif"/>'),a.ajax({type:'POST',data:e,url:'../managers/ases_report/load_not_assigned_students.php',success:function success(f){a('#not_assigned_students').html(''),a('#not_assigned_students').fadeIn(1e3).append('<table id="tableAssign" class="display" cellspacing="0" width="100%"><thead> </thead></table>'),a('#tableAssign').DataTable(f)},dataType:'json',cache:'false',error:function error(){alert('Error al cargar estudiantes no asignados')}})}function c(){var e=a('#form_general_report').serializeArray();e.push({name:'instance_id',value:d()}),a('#div_table').html('<img class="icon-loading" src="../icon/loading.gif"/>'),a.ajax({type:'POST',data:e,url:'../managers/ases_report/asesreport_server_processing.php',success:function success(f){a('#div_table').html(''),a('#div_table').fadeIn(1e3).append('<table id="tableResult" class="display" cellspacing="0" width="100%"><thead> </thead></table>'),a('#tableResult').DataTable(f),a('#tableResult tr').each(function(){a.each(this.cells,function(){'Bajo'==a(this).html()?a(this).addClass('bajo'):'Medio'==a(this).html()?a(this).addClass('medio'):'Alto'==a(this).html()&&a(this).addClass('alto')})}),a('#tableResult').bind('DOMSubtreeModified',function(){a('#tableResult tr').each(function(){a.each(this.cells,function(){'bajo'==a(this).html()?a(this).addClass('bajo'):'medio'==a(this).html()?a(this).addClass('medio'):'alto'==a(this).html()&&a(this).addClass('alto')})})})},dataType:'json',cache:'false',error:function error(){alert('Error al conectar con el servidor')}})}function d(){var e=location.search.split('&');for(x in e)if(0<=e[x].indexOf('instanceid')){var f=e[x].split('=');return f[1]}return 0}return{init:function init(){a('#send_form_btn').on('click',function(){c(),b()}),a(document).on('click','#tableAssign tbody tr td #student_assign',function(){var e=a('#tableAssign').DataTable(),f=e.row(a(this).parents('tr')).data(),g=d(),h=f.username,i=a(this).closest('tr').find('#monitors').val(),j=a(this).closest('tr').find('#practicants').val(),k=!0,l='';'--'==i&&(k=!1,l+='* Debe elegir monitor a asignar \n'),'--'==j&&(k=!1,l+='*Debe elegir practicantes a asignar'),k?a.ajax({type:'POST',data:{type:'assign_student',monitor:i,practicant:j,instance:g,student:h},url:'../managers/ases_report/asesreport.php',success:function success(m){alert(m)},dataType:'text',cache:'false',error:function error(m){console.log('Error al asignar estudiantes'+m)}}):alert(l)}),a(document).on('click','#tableResult tbody tr td',function(){var f=a('#tableResult').DataTable(),g=f.cell(this).index().column;2>=g&&(a('#formulario').each(function(){this.reset}),location.href='student_profile.php'+location.search+'&student_code='+f.cell(f.row(this).index(),0).data())}),a(document).on('change','#tableResult thead tr th select',function(){var e=a('#tableResult').DataTable(),f=a(this).parent().index()+1,g=a(this).parent().find(':selected').text();e.columns(f-1).search(this.value).draw()})}}});