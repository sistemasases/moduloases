'use strict';define(['jquery','block_ases/Modernizr-v282','block_ases/bootstrap','block_ases/datatables','block_ases/sweetalert','block_ases/select2'],function(e){return{init:function init(){function s(oe,ie){if('primer_acercamiento'==oe&&'insert'==ie);else if('primer_acercamiento'==oe&&'update'==ie);else if('seguimiento_pares'==oe&&'insert'==ie);else if('seguimiento_pares'==oe&&'update'==ie){var re=e('.dphpforms-record').find('.revisado_profesional').find('.checkbox').find('input[type=checkbox]').prop('checked');re&&e('.btn-dphpforms-update').remove();var te=e('.dphpforms-record .btn-dphpforms-univalle').length;console.log(te),2==te?e('.dphpforms-record .btn-dphpforms-close').css({'margin-left':e('.dphpforms-updater').width()/2-30+'px'}):3==te&&e('.dphpforms-record .btn-dphpforms-univalle:eq(0)').css({'margin-left':e('.dphpforms-updater').width()/2-72-30+'px'})}else if('seguimiento_geografico_'==oe&&'insert'==ie);else if('seguimiento_geografico_'==oe&&'update'==ie);else if('seguimiento_grupal_'==oe&&'insert'==ie);else if('seguimiento_grupal_'==oe&&'update'==ie);}function l(){e('.dphpforms-peer-record').on('click',function(){var oe=e(this).attr('data-record-id');g('seguimiento_pares',oe),e('#modal_v2_edit_peer_tracking').fadeIn(300)})}function c(){e('.dphpforms-groupal-record').on('click',function(){var oe=e(this).attr('data-record-id');g('seguimiento_grupal',oe),e('#modal_v2_edit_groupal_tracking').fadeIn(300)})}function p(){e('a[class*="practicant"]').click(function(){var oe=e(this).attr('href').split('#practicant')[1],ie=e(this).attr('href');e.ajax({type:'POST',data:{type:'get_practicants_of_professional',practicant_code:oe,instance:M()},url:'../managers/pilos_tracking/pilos_tracking_report.php',async:!1,success:function success(re){e(ie+' > div').empty(),e(ie+' > div').append(re),d(),_()},dataType:'json',cache:'false',error:function error(){swal({title:'Oops !',text:'Se present\xF3 un inconveniente con el practicante seleccionado.',html:!0,type:'warning',confirmButtonColor:'#d51b23'})}})})}function d(){e('a[class*="monitor"]').click(function(){var oe=e(this).attr('href').split('#monitor')[1],ie=e(this).attr('href');e.ajax({type:'POST',data:{type:'get_monitors_of_practicant',monitor_code:oe,instance:M()},url:'../managers/pilos_tracking/pilos_tracking_report.php',async:!1,success:function success(re){e(ie+' > div').empty(),e(ie+' > div').append(re),m(),_()},dataType:'json',cache:'false',error:function error(){swal({title:'Oops !',text:'Se present\xF3 un inconveniente con el monitor seleccionado.',html:!0,type:'warning',confirmButtonColor:'#d51b23'})}})})}function _(){e('a[class*="groupal"]').click(function(){var oe=e(this).attr('href').split('#groupal')[1],ie=e(this).attr('href');e.ajax({type:'POST',data:{type:'get_groupal_trackings',student_code:oe,instance:ee},url:'../managers/pilos_tracking/pilos_tracking_report.php',async:!1,success:function success(re){e(ie+' > div').empty(),e(ie+' > div').append(re),c()},dataType:'json',cache:'false',error:function error(){swal({title:'Oops !',text:'Se present\xF3 un inconveniente con los seguimientos grupales seleccionados.',html:!0,type:'warning',confirmButtonColor:'#d51b23'})}})})}function m(){e('a[class*="student"]').click(function(){var oe=e(this).attr('href').split('#student')[1],ie=e(this).attr('href');e.ajax({type:'POST',data:{type:'get_student_trackings',student_code:oe,instance:ee},url:'../managers/pilos_tracking/pilos_tracking_report.php',async:!1,success:function success(re){e(ie+' > div').empty(),e(ie+' > div').append(re),l(),c()},dataType:'json',cache:'false',error:function error(){swal({title:'Oops !',text:'Se present\xF3 un inconveniente con el estudiante seleccionado.',html:!0,type:'warning',confirmButtonColor:'#d51b23'})}})})}function f(oe){e.ajax({type:'POST',data:{students:oe,type:'consult_students_name'},url:'../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php',async:!1,success:function success(ie){if(''!=ie){e('#modal_v2_edit_groupal_tracking').find('#students').remove(),e('#modal_v2_edit_groupal_tracking').find('form').find('h1').after('<hr style="border-color:red"><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 estudiantes" id="students"><h3>Estudiantes asistentes:</h3><br>'+ie+'<br>')}},dataType:'text',cache:'false',error:function error(){alert('Error al consultar nombres de los estudiantes pertenecientes a un seguimiento grupal')}})}function g(oe,ie){e.get('../managers/dphpforms/dphpforms_forms_core.php?form_id='+oe+'&record_id='+ie,function(re){if('seguimiento_grupal'==oe){e('#body_editor').html(''),e('#modal_v2_edit_groupal_tracking').find('#body_editor').html(''),e('#modal_v2_edit_groupal_tracking').find('#body_editor').append(re),e('#modal_v2_edit_groupal_tracking').find('.btn-dphpforms-univalle').remove();var te=e('#modal_v2_edit_groupal_tracking').find('form').find('.oculto.id_estudiante').find('input').val();f(te)}else{e('#modal_v2_edit_groupal_tracking').find('#body_editor').html(''),e('#body_editor').html(''),e('#body_editor').append(re),e('.dphpforms.dphpforms-record.dphpforms-updater').append('<br><br><div class="div-observation col-xs-12 col-sm-12 col-md-12 col-lg-12 comentarios_vida_uni">Observaciones de Practicante/profesional:<br> <textarea id="observation_text" class="form-control " name="observation_text" maxlength="5000"></textarea><br><a id="send_observation" class="btn btn-sm btn-danger btn-dphpforms-univalle btn-dphpforms-send-observation">Enviar observaci\xF3n</a></div>'),e('button.btn.btn-sm.btn-danger.btn-dphpforms-univalle').attr('id','button');var ne=re.indexOf('seguimiento_de_pares_');-1!=ne&&s('seguimiento_pares','update')}e('#permissions_informationr').html('');var se=e('.dphpforms-record').find('.revisado_profesional').find('.checkbox').find('input[type=checkbox]').prop('checked'),le=e('.dphpforms-record').find('.revisado_practicante').find('.checkbox').find('input[type=checkbox]').prop('checked');(se||le)&&e('.dphpforms-record').find('.btn-dphpforms-delete-record').remove();for(var ce=JSON.parse(e('#permissions_information').text()),pe=0;pe<ce.behaviors_permissions.length;pe++){for(var ue,de=ce.behaviors_permissions[pe].behaviors[0],_e=de.behaviors_accessibility,me=0;me<_e.length;me++)ue=_e[me].disabled,'true'==ue?ue=!0:'false'==ue&&(ue=!1),e('.dphpforms-record').find('#'+_e[me].id).prop('disabled',ue),e('.dphpforms-record').find('.'+_e[me]['class']).prop('disabled',ue);for(var he=de.behaviors_fields_to_remove,me=0;me<he.length;me++)e('.dphpforms-record').find('#'+he[me].id).remove(),e('.dphpforms-record').find('.'+he[me]['class']).remove();for(var fe=de.limpiar_to_eliminate,me=0;me<fe.length;me++)e('.dphpforms-record').find('.'+fe[me]['class']+'.limpiar ').remove()}e('#permissions_informationr').html('')})}function v(oe,ie){e('#periodos').change(function(){if('sistemas'!=namerol){var re=e('#periodos').val(),te=Y;e.ajax({type:'POST',data:{id_persona:te,id_semestre:re,instance:oe,otro:!0,type:'consulta_sistemas'},url:'../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php',async:!1,success:function success(ne){''==ne?(e('#reemplazarToogle').html('<label> No se encontraron registros </label>'),k(ie)):(e('#reemplazarToogle').html(ne),m(),d(),p(),_()),e('.well.col-md-10.col-md-offset-1.reporte-seguimiento.oculto').slideDown('slow'),k(ie)},dataType:'text',cache:'false',error:function error(){alert('error al consultar seguimientos de personas')}}),l(),c()}})}function b(oe){e('#personas').val('').change(),e('#personas').select2({placeholder:'Seleccionar persona',language:{noResults:function noResults(){return'No hay resultado'},searching:function searching(){return'Buscando..'}}}),e('#periodos').select2({language:{noResults:function noResults(){return'No hay resultado'},searching:function searching(){return'Buscando..'}}}),P(oe,namerol),e('#consultar_persona').on('click',function(){var ie=e('#personas').children(':selected').attr('value'),re=e('#periodos').children(':selected').attr('value');ie==void 0?swal({title:'Debe escoger una persona para realizar la consulta',html:!0,type:'warning',confirmButtonColor:'#d51b23'}):(e('.well.col-md-10.col-md-offset-1.reporte-seguimiento.oculto').show(),e('.se-pre-con').show(),e('#reemplazarToogle').hide(),e.ajax({type:'POST',data:{id_persona:ie,id_semestre:re,instance:oe,type:'consulta_sistemas'},url:'../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php',async:!1,success:function success(ne){''==ne?e('#reemplazarToogle').html('<label> No se encontraron registros </label>'):(e('#reemplazarToogle').html(ne),e('input[name=practicante]').prop('disabled',!0),e('input[name=profesional]').prop('disabled',!0)),m(),d(),p(),_(),e('.well.col-md-10.col-md-offset-1.reporte-seguimiento.oculto').slideDown('slow')},dataType:'text',cache:'false',error:function error(){alert('error al consultar seguimientos de personas')},complete:function complete(){e('.se-pre-con').hide(),e('#reemplazarToogle').fadeIn()}}),l(),c())})}function k(oe){var ie=e('#periodos option:selected').text(),re=0,te='';if('monitor_ps'==oe.namerol){var ne=y(oe);te='<div class="row"><div class="col-sm-12"><h2>Informaci\xF3n monitor - PERIODO :'+ie+' </h2><div class="panel panel-default"> <div class="panel-body"><h4 class="panel-title"><span class="pull-left"> Revisados  :<label for="revisado_monitor_'+re+'">'+ne[0]+'</label><b></b> - NO Revisados :<label for="norevisado_monitor_'+re+'">'+ne[1]+'</label><b></b> - Total  :<label for="total_monitor_'+re+'">'+ne[2]+'</label> <b></b> </span></h4></div></div></div></div>',e('#conteo_principal').empty(),e('#conteo_principal').html(te)}else if('practicante_ps'==oe.namerol){var se=y(oe);te='<div class="row"><div class="col-sm-12"><h2>Informaci\xF3n practicante - PERIODO :'+ie+' </h2><div class="panel panel-default"> <div class="panel-body"><h4 class="panel-title"><span class="pull-left"> Revisados  :'+se[0]+' <b></b> - NO Revisados :'+se[1]+' <b></b> - Total  :'+se[2]+' <b></b> </span></h4></div></div></div></div>',e('#conteo_principal').empty(),e('#conteo_principal').html(te)}else if('profesional_ps'==oe.namerol){var le=y(oe);te='<div class="row"><div class="col-sm-12"><h2>Informaci\xF3n profesional - PERIODO :'+ie+' </h2><div class="panel panel-default"> <div class="panel-body"><h4 class="panel-title"><span class="pull-left"> Revisados  :'+le[0]+' <b></b> - NO Revisados :'+le[1]+' <b></b> - Total  :'+le[2]+' <b></b> </span></h4></div></div></div></div>',e('#conteo_principal').empty(),e('#conteo_principal').html(te)}else if('sistemas'==oe.namerol);}function y(oe,ie){ie===void 0&&(ie='ninguno');var re=[],te=0,ne=0,se=0,le=0;if('monitor_ps'==oe.namerol){var ce=0,pe=0;'ninguno'==ie?(ce=e('.panel-heading.pares').children().length,pe=e('.panel-heading.grupal').children().length):(ce=e('#collapse'+oe.id+' .panel-heading.pares').children().length,pe=e('#collapse'+oe.id+' .panel-heading.grupal').children().length),e('label[for=\'norevisado_grupal_'+oe.id+'\']').html(pe),e('label[for=\'total_grupal_'+oe.id+'\']').html(pe);for(var de=0;de<ce;de++)se+=+e('label[for=\'revisado_pares_'+oe.id+'_'+de+'\']').text(),le+=+e('label[for=\'norevisado_pares_'+oe.id+'_'+de+'\']').text();for(var de=0;de<pe;de++)te+=0,ne=pe;return total=se+te+(le+ne),[se+te,le+ne,total]}if('practicante_ps'==oe.namerol){var _e=0;re=[0,0,0];var me=[];if('ninguno'==ie){_e=e('.panel-heading.practicante').children().length;for(var ue=0;ue<_e;ue++){var he=e('.panel-heading.practicante:eq('+ue+')').find('a').attr('href'),fe=he.split('#collapse')[1],ge=[];ge.id=fe,ge.namerol='monitor_ps',me=y(ge,'practicante'),e('label[for=\'revisado_monitor_'+fe+'\']').html(me[0]),e('label[for=\'norevisado_monitor_'+fe+'\']').html(me[1]),e('label[for=\'total_monitor_'+fe+'\']').html(me[2]),re[0]+=me[0],re[1]+=me[1],re[2]+=me[2]}}else{_e=e('#collapse'+oe.id+' .panel-heading.practicante').children().length;for(var ue=0;ue<_e;ue++){var he=e('#collapse'+oe.id+' .panel-heading.practicante:eq('+ue+')').find('a').attr('href'),fe=he.split('#collapse')[1],ge=[];ge.id=fe,ge.namerol='monitor_ps',me=y(ge,'practicante'),e('label[for=\'revisado_monitor_'+fe+'\']').html(me[0]),e('label[for=\'norevisado_monitor_'+fe+'\']').html(me[1]),e('label[for=\'total_monitor_'+fe+'\']').html(me[2]),re[0]+=me[0],re[1]+=me[1],re[2]+=me[2]}}return re}if('profesional_ps'==oe.namerol){re=[0,0,0];for(var ve=e('.panel-heading.profesional').children().length,be=[],ke=0;ke<ve;ke++){var he=e('.panel-heading.profesional:eq('+ke+')').find('a').attr('href'),ye=he.split('#collapse')[1],xe=[];xe.id=ye,xe.namerol='practicante_ps',be=y(xe,'practicante'),e('label[for=\'revisado_practicante_'+ye+'\']').html(be[0]),e('label[for=\'norevisado_practicante_'+ye+'\']').html(be[1]),e('label[for=\'total_practicante_'+ye+'\']').html(be[2]),re[0]+=be[0],re[1]+=be[1],re[2]+=be[2]}return re}}function C(oe){e('body').on('click','#send_observation',function(){var ie=e('form').serializeArray(),re={};e(ie).each(function(ue,he){re[he.name]=he.value});var te=re.id_registro,ne=e('#observation_text');if(console.log(),''==ne.val())swal({title:'Para enviar una observaci\xF3n debe llenar el campo correspondiente',html:!0,type:'error',confirmButtonColor:'#d51b23'});else{var le=e('.id_creado_por').find('input').val(),ce=e('.fecha').find('input').val(),pe=ne.val(),de=e('#periodos').val(),_e=e('.lugar').find('input').val();e.ajax({type:'POST',data:{id_tracking:te,type:'send_email_to_user',form:'new_form',tracking_type:'individual',monitor_code:le,date:ce,message_to_send:pe,semester:de,instance:oe,place:_e},url:'../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php',async:!1,success:function success(ue){console.log(ue),'Error'==ue?(console.log('mensaje error : '+ue),swal({title:'error al enviar el correo al monitor',html:!0,type:'error',confirmButtonColor:'#d51b23'})):(swal({title:'Correo enviado',html:!0,type:'success',confirmButtonColor:'#d51b23'}),ne.val(''))},dataType:'text',cache:'false',error:function error(ue){console.log('mensaje error : '+ue),swal({title:'error al enviar el correo',html:!0,type:'error',confirmButtonColor:'#d51b23'})}})}})}function O(){e('body').on('click','.btn.btn-info.btn-lg.botonCorreo',function(){var ie=e(this).attr('value'),re=e('#textarea_'+ie);if(''==re.val())swal({title:'Para enviar una observaci\xF3n debe llenar el campo correspondiente',html:!0,type:'error',confirmButtonColor:'#d51b23'});else{var te=re.attr('name').split('_'),ne=te[0],se=te[1],le=te[2],ce=te[3],pe=te[4],de=re.val();e.ajax({type:'POST',data:{type:'send_email_to_user',tipoSeg:ne,codigoEnviarN1:se,codigoEnviarN2:le,fecha:ce,nombre:pe,message:de},url:'../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php',async:!1,success:function success(me){'Error'==me?swal({title:'error al enviar el correo al monitor',html:!0,type:'error',confirmButtonColor:'#d51b23'}):(swal({title:'Correo enviado',html:!0,type:'success',confirmButtonColor:'#d51b23'}),re.val(''))},dataType:'text',cache:'false',error:function error(){swal({title:'error al enviar el correo',html:!0,type:'error',confirmButtonColor:'#d51b23'})}})}})}function T(oe){e('body').on('click','span.btn.btn-info.btn-lg.botonModificarSeguimiento',function(){var ie=e(this).attr('value'),re='',te='',ne=document.getElementById('h_ini_'+ie),se=document.getElementById('h_fin_'+ie),le=document.getElementById('m_ini_'+ie),ce=document.getElementById('m_fin_'+ie),pe=ne.options[ne.selectedIndex].text,de=se.options[se.selectedIndex].text,_e=le.options[le.selectedIndex].text,me=ce.options[ce.selectedIndex].text,ue=R(pe,de,_e,me);if(I(ie,oe),''==ue){re=e('#profesional_'+ie).is(':checked')?1:0,te=e('#practicante_'+ie).is(':checked')?1:0;var he=e(this).parent().parent().parent(),fe=e(this).attr('value'),ge=he.find('#lugar_'+fe).val(),ve=he.find('#tema_'+ie).val(),be=he.find('#objetivos_'+ie).val(),ke=he.find('#fecha_'+ie).val(),Ce=he.find('#obindividual_'+ie).val(),Oe=e('input[name=\'riesgo_individual_'+ie+'\']:checked').val();void 0==Oe&&(Oe='0');var Te=he.find('#obfamiliar_'+ie).val(),we=e('input[name=\'riesgo_familiar_'+ie+'\']:checked').val();void 0==we&&(we='0');var Se=he.find('#obacademico_'+ie).val(),Be=e('input[name=\'riesgo_academico_'+ie+'\']:checked').val();void 0==Be&&(Be='0');var je=he.find('#obeconomico_'+ie).val(),Ie=e('input[name=\'riesgo_economico_'+ie+'\']:checked').val();void 0==Ie&&(Ie='0');var Pe=he.find('#obuniversitario_'+ie).val(),ze=e('input[name=\'riesgo_universitario_'+ie+'\']:checked').val();void 0==ze&&(ze='0');var Ee=he.find('#observacionesGeneral_'+ie).val();if(''==ge||''==ve||''==be)swal({title:'Debe ingresar los datos completamente',html:!0,type:'warning',confirmButtonColor:'#d51b23'});else if(!(''!=Ce&&0==Oe||''!=Te&&0==we||''!=Se&&0==Be||''!=je&&0==Ie||''!=Pe&&0==ze||''==Ce&&0<Oe||''==Te&&0<we||''==Se&&0<Be||''==je&&0<Ie||''==Pe&&0<ze)){var Re={};Re.id=fe,Re.lugar=ge,Re.tema=ve,Re.objetivos=be,Re.individual=Ce,Re.individual_riesgo=Oe,Re.familiar_desc=Te,Re.familiar_riesgo=we,Re.academico=Se,Re.academico_riesgo=Be,Re.economico=je,Re.economico_riesgo=Ie,Re.vida_uni=Pe,Re.vida_uni_riesgo=ze,Re.observaciones=Ee,Re.revisado_practicante=te,Re.revisado_profesional=re,Re.fecha=ke,Re.hora_ini=pe+':'+_e,Re.hora_fin=de+':'+me,e.ajax({type:'POST',data:{seguimiento:Re,type:'actualizar_registro'},url:'../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php',async:!1,success:function success(Ne){'0'==Ne?swal({title:'error al actualizar registro',html:!0,type:'error',confirmButtonColor:'#d51b23'}):'1'==Ne?swal('\xA1Hecho!','El registro ha sido actualizado','success'):swal({title:'Debe ingresar correctamente los riesgos',html:!0,type:'warning',confirmButtonColor:'#d51b23'})},error:function error(){}})}else swal({title:'Debe ingresar correctamente los riesgos',html:!0,type:'warning',confirmButtonColor:'#d51b23'})}else swal({title:ue,html:!0,type:'warning',confirmButtonColor:'#d51b23'})})}function w(oe){e('body').on('click','span.btn-info.btn-lg.botonesSeguimiento.botonEditarSeguimiento',function(){var ie=e(this).attr('value'),re=e(this).parent().parent().parent(),te=!1;'monitor_ps'==oe?te=e('#profesional_'+ie).is(':checked'):'practicante_ps'==oe?e('input[name=practicante]').prop('disabled',!1):'profesional_ps'==oe?e('input[name=profesional]').prop('disabled',!1):'sistemas'==oe&&(e('input[name=profesional]').prop('disabled',!1),e('input[name=practicante]').prop('disabled',!1)),!1==te?(re.find('.editable').removeAttr('readonly'),re.find('.botonesSeguimiento').toggleClass('ocultar'),re.find('.quitar-ocultar').toggleClass('ocultar'),re.find('.radio-ocultar').toggleClass('ocultar'),A(ie),H(ie)):swal('\xA1Advertencia!','No es posible editar el seguimiento, debido a que ya ha sido revisado por un profesional','warning')})}function S(oe){e('body').on('click','span.btn.btn-info.btn-lg.botonBorrar',function(){var ie=e(this).attr('value'),re=!1;'monitor_ps'==oe?re=e('#profesional_'+Y).is(':checked'):'practicante_ps'==oe||'profesional_ps'==oe,!1==re&&swal({title:'\xBFSeguro que desea eliminar el registro?',text:'No podr\xE1s deshacer este paso',type:'warning',showCancelButton:!0,cancelButtonText:'No',confirmButtonColor:'#d51b23',confirmButtonText:'Si',closeOnConfirm:!1},function(){e.ajax({type:'POST',data:{id:ie,type:'eliminar_registro'},url:'../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php',async:!1,success:function success(te){swal({title:te.title,html:!0,text:te.msg,type:te.type,confirmButtonColor:'#d51b23'}),setTimeout('document.location.reload()',500)},dataType:'json',cache:'false',error:function error(){}})})})}function B(oe){e('body').on('click','span.btn.btn-info.btn-lg.botonesSeguimiento.botonCancelarSeguimiento',function(){var ie=e(this).attr('value');'monitor_ps'==oe||('practicante_ps'==oe?e('input[name=practicante]').prop('disabled',!0):'profesional_ps'==oe?e('input[name=profesional]').prop('disabled',!0):'sistemas'==oe&&(e('input[name=profesional]').prop('disabled',!0),e('input[name=practicante]').prop('disabled',!0)));var re=e(this).parent().parent().parent();re.find('.editable').attr('readonly',!0),re.find('.botonesSeguimiento').toggleClass('ocultar'),re.find('.quitar-ocultar').toggleClass('ocultar'),re.find('.radio-ocultar').toggleClass('ocultar'),D(ie)})}function j(){e('body').on('click','.limpiar',function(){var oe=e(this).closest('div').attr('id').split('_'),ie=oe[2].split('div').pop();switch(oe[1]){case'individual':e('#obindividual_'+ie).val(''),U('riesgo_individual_',ie);break;case'familiar':e('#obfamiliar_'+ie).val(''),U('riesgo_familiar_',ie);break;case'academico':e('#obacademico_'+ie).val(''),U('riesgo_academico_',ie);break;case'economico':e('#obeconomico_'+ie).val(''),U('riesgo_economico_',ie);break;case'universitario':e('#obuniversitario_'+ie).val(''),U('riesgo_universitario_',ie);break;default:e(this).parent().find('.opcionesRadio').find('div').each(function(){e(this).find('label').find('input').prop('checked',!1)});}})}function I(oe,ie){var re=[],te=[],ne=e('input:radio[name=riesgo_individual_'+oe+']:checked').val(),se=e('input:radio[name=riesgo_familiar_'+oe+']:checked').val(),le=e('input:radio[name=riesgo_academico_'+oe+']:checked').val(),ce=e('input:radio[name=riesgo_economico_'+oe+']:checked').val(),pe=e('input:radio[name=riesgo_universitario_'+oe+']:checked').val();'3'==ne&&(re.push('Individual'),te.push(e('#obindividual_'+oe).val())),'3'==se&&(re.push('Familiar'),te.push(e('#obfamiliar_'+oe).val())),'3'==le&&(re.push('Acad\xE9mico'),te.push(e('#obacademico_'+oe).val())),'3'==ce&&(re.push('Econ\xF3mico'),te.push(e('#obeconomico_'+oe).val())),'3'==pe&&(re.push('Vida universitaria'),te.push(e('#obuniversitario_'+oe).val()));var de=[];de.push({name:'function',value:'send_email'}),de.push({name:'id_student_moodle',value:ie}),de.push({name:'id_student_pilos',value:oe}),de.push({name:'risk_array',value:re}),de.push({name:'observations_array',value:te}),de.push({name:'date',value:e('#fecha_'+oe).val()}),de.push({name:'url',value:window.location}),0!=re.length&&e.ajax({type:'POST',data:de,url:'../managers/pilos_tracking/send_risk_email.php',success:function success(_e){console.log(_e)},dataType:'text',cache:'false',error:function error(_e){console.log(_e)}})}function P(oe,ie){e('#periodos').change(function(){var re=e('#periodos').val();e.ajax({type:'POST',data:{id:re,instance:oe,type:'actualizar_personas'},url:'../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php',async:!1,success:function success(te){if(e('#personas').empty(),e('#personas').select2({placeholder:'Seleccionar persona',language:{noResults:function noResults(){return'No hay resultado'},searching:function searching(){return'Buscando..'}}}),'sistemas'==ie){e('#personas').attr('selectedIndex','-1').find('option:selected').removeAttr('selected'),e('#personas').append('<option value="">Seleccionar persona</option>'+te)}},dataType:'text',cache:'false',error:function error(){alert('error al cargar personas')}})})}function R(oe,ie,re,te){var ne='';return oe>ie?ne+='* La hora final debe ser mayor a la inicial<br>':oe==ie&&(re>te?(isvalid=!1,ne+='* La hora final debe ser mayor a la inicial<br>'):re==te&&(ne+='* Las horas seleccionadas deben ser diferentes<br>')),ne}function N(oe){for(var ie=new Date,re=ie.getMinutes(),te=ie.getHours(),ne='',se=0;24>se;se++)se==te?(10>te&&(te='0'+te),ne+='<option value="'+te+'" selected>'+te+'</option>'):ne+=10>se?'<option value="0'+se+'">0'+se+'</option>':'<option value="'+se+'">'+se+'</option>';for(var le='',se=0;60>se;se++)se==re?(10>re&&(re='0'+re),le+='<option value="'+re+'" selected>'+re+'</option>'):le+=10>se?'<option value="0'+se+'">0'+se+'</option>':'<option value="'+se+'">'+se+'</option>';e('#h_ini_'+oe).append(ne),e('#m_ini_'+oe).append(le),e('#h_fin_'+oe).append(ne),e('#m_fin_'+oe).append(le),e('#seguimiento #m_fin').append(le)}function q(){e(document).ready(function(){e('input:radio').change(function(){var oe=e(this).parent().parent().parent().attr('id'),ie=e(this).attr('value');1==ie?(e('#'+oe).removeClass(),e('#'+oe).addClass('table-info-pilos col-sm-12 riesgo_bajo')):2==ie?(e('#'+oe).removeClass(),e('#'+oe).addClass('table-info-pilos col-sm-12 riesgo_medio')):3==ie&&(e('#'+oe).removeClass(),e('#'+oe).addClass('table-info-pilos col-sm-12 riesgo_alto'))})})}function D(oe){e('#titulo_fecha_'+oe).hide(),e('#borrar_'+oe).show(),e('#editar_'+oe).show(),e('#enviar_'+oe).show(),e('#hora_final_'+oe).show(),e('#mod_hora_final_'+oe).hide(),e('#hora_inicial_'+oe).show(),e('#mod_hora_ini_'+oe).hide()}function A(oe){e('#borrar_'+oe).hide(),e('#editar_'+oe).hide(),e('#enviar_'+oe).hide(),e('#hora_final_'+oe).hide(),e('#hora_inicial_'+oe).hide(),e('#titulo_fecha_'+oe).show(),e('#mod_hora_final_'+oe).show(),e('#mod_hora_ini_'+oe).show();var ie=e('#h_inicial_texto_'+oe).val(),re=e('#h_final_texto_'+oe).val(),te=ie.split(':'),ne=re.split(':');N(oe),e('#h_ini_'+oe+' option[value='+te[0]+']').prop('selected',!0),e('#m_ini_'+oe+' option[value='+te[1]+']').prop('selected',!0),e('#h_fin_'+oe+' option[value='+ne[0]+']').prop('selected',!0),e('#m_fin_'+oe+' option[value='+ne[1]+']').prop('selected',!0)}function U(oe,ie){e('input:radio[name='+oe+ie+']').parent().parent().parent().removeClass('riesgo_bajo'),e('input:radio[name='+oe+ie+']').parent().parent().parent().removeClass('riesgo_medio'),e('input:radio[name='+oe+ie+']').parent().parent().parent().removeClass('riesgo_alto');var re='"'+oe.replace('#','')+ie+'"';e('input:radio[name='+re+']').each(function(){this.checked=!1})}function M(){for(var re,oe=window.location.search.split('&'),ie=0;ie<oe.length;ie++)if(re=oe[ie].split('='),'?instanceid'==re[0]||'instanceid'==re[0])var te=re[1];return te}function H(oe){e('#riesgo_individual_'+oe).is('.riesgo_bajo')?e('input[name=riesgo_individual_'+oe+'][value=1]').prop('checked','checked'):e('#riesgo_individual_'+oe).is('.riesgo_medio')?e('input[name=riesgo_individual_'+oe+'][value=2]').prop('checked','checked'):e('#riesgo_individual_'+oe).is('.riesgo_alto')?e('input[name=riesgo_individual_'+oe+'][value=3]').prop('checked','checked'):e('input[name=riesgo_individual_'+oe+'][value=0]').prop('checked','checked'),e('#riesgo_familiar_'+oe).is('.riesgo_bajo')?e('input[name=riesgo_familiar_'+oe+'][value=1]').prop('checked','checked'):e('#riesgo_familiar_'+oe).is('.riesgo_medio')?e('input[name=riesgo_familiar_'+oe+'][value=2]').prop('checked','checked'):e('#riesgo_familiar_'+oe).is('.riesgo_alto')?e('input[name=riesgo_familiar_'+oe+'][value=3]').prop('checked','checked'):e('input[name=riesgo_familiar_'+oe+'][value=0]').prop('checked','checked'),e('#riesgo_academico_'+oe).is('.riesgo_bajo')?e('input[name=riesgo_academico_'+oe+'][value=1]').prop('checked','checked'):e('#riesgo_academico_'+oe).is('.riesgo_medio')?e('input[name=riesgo_academico_'+oe+'][value=2]').prop('checked','checked'):e('#riesgo_academico_'+oe).is('.riesgo_alto')?e('input[name=riesgo_academico_'+oe+'][value=3]').prop('checked','checked'):e('input[name=riesgo_academico_'+oe+'][value=0]').prop('checked','checked'),e('#riesgo_economico_'+oe).is('.riesgo_bajo')?e('input[name=riesgo_economico_'+oe+'][value=1]').prop('checked','checked'):e('#riesgo_economico_'+oe).is('.riesgo_medio')?e('input[name=riesgo_economico_'+oe+'][value=2]').prop('checked','checked'):e('#riesgo_economico_'+oe).is('.riesgo_alto')?e('input[name=riesgo_economico_'+oe+'][value=3]').prop('checked','checked'):e('input[name=riesgo_economico_'+oe+'][value=0]').prop('checked','checked'),e('#riesgo_universitario_'+oe).is('.riesgo_bajo')?e('input[name=riesgo_universitario_'+oe+'][value=1]').prop('checked','checked'):e('#riesgo_universitario_'+oe).is('.riesgo_medio')?e('input[name=riesgo_universitario_'+oe+'][value=2]').prop('checked','checked'):e('#riesgo_universitario_'+oe).is('.riesgo_alto')?e('input[name=riesgo_universitario_'+oe+'][value=3]').prop('checked','checked'):e('input[name=riesgo_universitario_'+oe+'][value=0]').prop('checked','checked')}var X=0,Y=0,Z='',ee='',ae='';e(document).on('click','.btn-dphpforms-close',function(){e(this).closest('div[class="mymodal"]').fadeOut(300)}),e(document).ready(function(){e('.se-pre-con').fadeOut('slow'),e('#reemplazarToogle').fadeIn('slow');for(var te,oe='',ie=window.location.search.split('&'),re=0;re<ie.length;re++)if(te=ie[re].split('='),'?instanceid'==te[0]||'instanceid'==te[0])var ne=te[1];e.ajax({type:'POST',data:{type:'getInfo',instance:ne},url:'../../../blocks/ases/managers/pilos_tracking/pilos_tracking_report.php',async:!1,success:function success(se){$data=e.parseJSON(se),Z=$data.username,Y=$data.id,ae=$data.email,X=$data.rol,namerol=$data.name_rol},dataType:'text',cache:'false',error:function error(){swal({title:'error al obtener informaci\xF3n del usuario, getInfo.',html:!0,type:'error',confirmButtonColor:'#d51b23'})}}),Z='','monitor_ps'==namerol?oe='monitor':'practicante_ps'==namerol?oe='practicante':'profesional_ps'==namerol?oe='profesional':'sistemas'==namerol&&(oe='sistemas');var oe=[];oe.id=Y,oe.name=Z,oe.namerol=namerol,k(oe),'practicante_ps'==namerol?(e('input[name=profesional]').prop('disabled',!0),e('input[name=practicante]').prop('disabled',!0),j(),w(namerol),B(namerol),S(namerol),T(Y),q(),O(ne),v(ne,oe),C(ne)):'profesional_ps'==namerol?(e('input[name=practicante]').prop('disabled',!0),e('input[name=profesional]').prop('disabled',!0),j(),B(namerol),w(namerol),T(Y),S(namerol),q(),O(ne),v(ne,oe),C(ne)):'monitor_ps'==namerol?(j(),w(namerol),B(namerol),S(namerol),T(Y),q(),v(ne,oe)):'sistemas'==namerol&&(j(),w(namerol),B(namerol),S(namerol),T(Y),q(),O(ne),b(ne),C(ne))}),m(),d(),p(),_();e(document).on('click','.dphpforms > #button',function(oe){oe.preventDefault(),e(':disabled').prop('disabled',!1);var ie=new FormData,re=e(this).parent(),te=re.attr('action');'procesador.php'==re.attr('action')&&(te='../managers/dphpforms/procesador.php'),e.ajax({type:'POST',url:te,data:e('form.dphpforms').serialize(),dataType:'json',success:function success(ne){var se=ne;if(0==se.status){var le='';'Stored'==se.message?le='Almacenado':'Updated'==se.message&&(le='Actualizado'),swal({title:'Informaci\xF3n',text:le,type:'success'},function(){'Updated'==se.message&&e('#dphpforms-peer-record-'+e('#dphpforms_record_id').val()).stop().animate({backgroundColor:'rgb(175, 255, 173)'},400).animate({backgroundColor:'#f5f5f5'},4e3)}),e('.dphpforms-response').trigger('reset'),e('#modal_v2_edit_peer_tracking').fadeOut(300),e('#modal_v2_peer_tracking').fadeOut(300)}else if(-2==se.status){var le='';'Without changes'==se.message?(le='No hay cambios que registrar',e('#modal_v2_edit_peer_tracking').fadeOut(300),e('#modal_v2_peer_tracking').fadeOut(300),e('#modal_primer_acercamiento').fadeOut(300),e('#modal_seguimiento_geografico').fadeOut(300)):'Unfulfilled rules'==se.message&&(le='Revise los valores ingresados'),swal('Alerta',le,'warning')}else-1==se.status&&swal('ERROR!','Oops!, informe de este error','error')},error:function error(){swal('Error!','Oops!, informe de este error','error')}})}),e('.mymodal-close').click(function(){e(this).parent().parent().parent().parent().fadeOut(300)})}}});