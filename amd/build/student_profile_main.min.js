'use strict';define(['jquery','block_ases/bootstrap','block_ases/d3','block_ases/sweetalert','block_ases/jqueryui','block_ases/select2','block_ases/Chart'],function(a,b,c){function l(){a('#editar_ficha').click(function(){a('#ficha_estudiante').find('input').prop('readonly',!1),a('#observations_profile').prop('readonly',!1),a('#profesional_ps').prop('readonly',!0),a('#practicante_ps').prop('readonly',!0),a('#monitor_ps').prop('readonly',!0),a('#ficha_estudiante').find('select').prop('disabled',!1),a(this).hide(),a('#ficha_estudiante #cancel').fadeIn(),a('#ficha_estudiante #save').fadeIn(),a('#ficha_estudiante #codigo').attr('readonly',!0),a('#ficha_estudiante #search').fadeOut()})}function m(){a('#ficha_estudiante').find('input, textarea').prop('readonly',!0),a('#ficha_estudiante').find('select').prop('disabled',!0),a(this).hide(),a('#ficha_estudiante #save').fadeOut(),a('#ficha_estudiante #cancel').fadeOut(),a('#ficha_estudiante #editar_ficha').fadeIn(),a('#ficha_estudiante #codigo').attr('readonly',!1),a('#ficha_estudiante #search').fadeIn()}function n(){a('#go_back').on('click',function(){var T=location.search.split('&');location.href='ases_report.php'+T[0]+'&'+T[1]})}function p(){var S=a('#ficha_estudiante').serializeArray();if(q(S)){JSON.stringify(S);a.ajax({type:'POST',data:{func:'save_profile',form:S},url:'../managers/student_profile/studentprofile_serverproc.php',success:function success(U){swal(U.title,U.msg,U.status)},dataType:'json',cache:'false',error:function error(U){swal(U.title,U.msg,U.status)}})}m()}function q(S){return r(S[4].value)?(swal('Error','El campo "Documento" solo debe contener n\xFAmeros','error'),0):''==S[4].value?(swal('Error','El campo "Documento" no puede estar vacio','error'),0):''==S[6].value?(swal('Error','El campo "Documento" no puede estar vacio','error'),0):r(S[7].value)?(swal('Error','El campo "Tel\xE9fono 1" solo debe contener n\xFAmeros','error'),0):r(S[8].value)?(swal('Error','El campo "Tel\xE9fono 2" solo debe contener n\xFAmeros','error'),0):r(S[9].value)?(swal('Error','El campo "Tel\xE9fono 3" solo debe contener n\xFAmeros','error'),0):''==S[10].value?(swal('Error','El campo "Email alternativo" no puede estar vacio','error'),0):t(S[10].value)?(swal('Error','El formato del correo alternativo es incorrecto. \n El formato correcto deber\xEDa ser ejemplo@ejemplo.com','error'),0):''==S[11].value?(swal('Error','El campo "Nombre acudiente" no puede estar vacio','error'),0):r(S[12].value)?(swal('Error','El campo "Tel\xE9fono acudiente" solo debe contener n\xFAmeros','error'),0):1}function r(S){for(S=S.toLowerCase(),i=0;i<S.length;i++)if(-1!='abcdefghyjklmn\xF1opqrstuvwxyz'.indexOf(S.charAt(i),0))return 1;return 0}function t(S){var T=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;return T.test(S)?0:1}function u(){a('#description_dropout').val(''),a('#no_reason_option').attr('selected','selected')}function v(){var S;a('#estado').on('focus',function(){S=a('#estado option:selected').text()}).change(function(){var T=a('#estado option:selected').text();'RETIRADO'==T?(a('#modal_dropout').show(),a('#save_changes_dropout').click(function(){''==a('reasons_select').val()?swal({title:'Error',text:'Seleccione un m\xF3tivo',type:'error'}):B()})):'APLAZADO'==T?(a('#modal_dropout').show(),a('#save_changes_dropout').click(function(){''==a('reasons_select').val()?swal({title:'Error',text:'Seleccione un m\xF3tivo',type:'error'}):B()})):'NO REGISTRA'==T?swal({title:'Error',text:'Por favor seleccione un Estado Ases.',type:'error'}):swal({title:'\xBFEst\xE1 seguro/a de realizar este cambio?',text:'El estado Icetex del estudiante pasar\xE1 de '+S+' a '+T,type:'warning',showCancelButton:!0,confirmButtonColor:'#d51b23',confirmButtonText:'Si',cancelButtonText:'No',closeOnConfirm:!0,allowEscapeKey:!1},function(U){if(U){var V=B();swal(V.title,V.msg,resul_status.status)}else a('#estado').val(S)})})}function A(){var S;a('#estadoAses').on('focus',function(){S=a('#estadoAses option:selected').text()}).change(function(){var T=a('#estadoAses option:selected').text();'RETIRADO'==T?(a('#modal_dropout').show(),a('#save_changes_dropout').click(function(){''==a('reasons_select').val()?swal({title:'Error',text:'Seleccione un m\xF3tivo',type:'error'}):C()})):'APLAZADO'==T?(a('#modal_dropout').show(),a('#save_changes_dropout').click(function(){''==a('reasons_select').val()?swal({title:'Error',text:'Seleccione un m\xF3tivo',type:'error'}):C()})):'NO REGISTRA'==T?swal({title:'Error',text:'Por favor seleccione un Estado Ases.',type:'error'}):swal({title:'\xBFEst\xE1 seguro/a de realizar este cambio?',text:'El estado ASES del estudiante pasar\xE1 de '+S+' a '+T,type:'warning',showCancelButton:!0,confirmButtonColor:'#d51b23',confirmButtonText:'Si',cancelButtonText:'No',closeOnConfirm:!0,allowEscapeKey:!1},function(U){if(U){var V=C();swal(V.title,V.msg,resul_status.status)}else a('#estadoAses').val(S)})})}function B(){var S=[],T=a('#estado').val(),U=a('#id_ases').val(),V=a('#reasons_select').val(),W=a('#description_dropout').val();S.push({name:'func',value:'save_icetex_status'}),S.push({name:'new_status',value:T}),S.push({name:'id_ases',value:U}),''!=V&&S.push({name:'id_reason',value:V});''!=W&&S.push({name:'observations',value:W}),a.ajax({type:'POST',data:S,url:'../../ases/managers/student_profile/studentprofile_serverproc.php',success:function success(X){swal({title:X.title,text:X.msg,type:X.type}),a('#modal_dropout').hide(),u()},dataType:'json',cache:'false',error:function error(){swal('Error','No se puede contactar con el servidor.','error')}})}function C(){var S=[],T=a('#estadoAses').val(),U=a('#id_ases').val(),V=a('#reasons_select').val(),W=a('#description_dropout').val();S.push({name:'func',value:'save_ases_status'}),S.push({name:'new_status',value:T}),S.push({name:'id_ases',value:U}),''!=V&&S.push({name:'id_reason',value:V});''!=W&&S.push({name:'observations',value:W}),a.ajax({type:'POST',data:S,url:'../../ases/managers/student_profile/studentprofile_serverproc.php',success:function success(X){swal({title:X.title,text:X.msg,type:X.type}),a('#modal_dropout').hide(),u()},dataType:'json',cache:'false',error:function error(){swal('Error','El estado no fue actualizado. Error al contactarse con el servidor.','error')}})}function D(){var S=a('#modal_dropout'),T=a('.mymodal-close'),U=a('#goback_backdrop');U.on('click',function(){S.hide()}),T.on('click',function(){S.hide()})}function E(){var S=a('#modal_peer_tracking'),T=a('.mymodal-close'),U=a('#cancel_peer_tracking');U.on('click',function(){S.hide()}),T.on('click',function(){S.hide()});var V=a('.panel-heading.heading_semester_tracking');V.on('click',function(){'collapsed'==a(this).parent().attr('class')?(a('h4>span',this).removeClass('glyphicon-chevron-left'),a('h4>span',this).addClass('glyphicon-chevron-down')):(a('h4>span',this).removeClass('glyphicon-chevron-down'),a('h4>span',this).addClass('glyphicon-chevron-left'))})}function F(){var S=a('#modal_risk_span'),T=a('#modal_risk_close');S.on('click',function(){a('#modal_risk_graph').hide()}),T.on('click',function(){a('#modal_risk_graph').hide()})}function G(){a('#date').datepicker({dateFormat:'yy-mm-dd'});for(var S=new Date,T=S.getDate(),U=S.getMonth()+1,V=S.getFullYear(),W=S.getMinutes(),X=S.getHours(),Y='',Z=0;24>Z;Z++)Z==X?(10>X&&(X='0'+X),Y+='<option value="'+X+'" selected>'+X+'</option>'):Y+=10>Z?'<option value="0'+Z+'">0'+Z+'</option>':'<option value="'+Z+'">'+Z+'</option>';for(var _='',Z=0;60>Z;Z++)Z==W?(10>W&&(W='0'+W),_+='<option value="'+W+'" selected>'+W+'</option>'):_+=10>Z?'<option value="0'+Z+'">0'+Z+'</option>':'<option value="'+Z+'">'+Z+'</option>';a('#h_ini').append(Y),a('#m_ini').append(_),a('#h_fin').append(Y),a('#m_fin').append(_),a('#infomonitor').addClass('hide'),a('#seguimiento').find('input:text, textarea').val(''),a('#seguimiento').find('input:radio,input:checkbox').prop('checked',!1),a('#upd_seg').attr('disabled',!1),a('#upd_seg').attr('title',''),a('#seguimiento').find('select, textarea, input').attr('disabled',!1),a('#no_value_individual').hide(),a('#no_value_familiar').hide(),a('#no_value_academic').hide(),a('#no_value_economic').hide(),a('#no_value_life').hide(),a('#id_tracking_peer').val(''),a('#place').val(''),a('#topic_textarea').val(''),a('#objetivos').val(''),a('#individual').val(''),a('#familiar').val(''),a('#academico').val(''),a('#economico').val(''),a('#vida_uni').val(''),a('#observaciones').val(''),a('#no_value_individual').prop('checked',!0),a('#no_value_familiar').prop('checked',!0),a('#no_value_academic').prop('checked',!0),a('#no_value_economic').prop('checked',!0),a('#no_value_life').prop('checked',!0)}function H(){var S=a('#tracking_peer_form'),T=a('#modal_peer_tracking'),U=S.serializeArray(),V=J(document.location.search),W=I(U);if('success'!=W)swal({title:'Advertencia',text:W,type:'warning',html:!0});else{U.push({name:'func',value:'save_tracking_peer'});var X=a('#id_ases').val();U.push({name:'id_ases',value:X}),U.push({name:'id_instance',value:V.instanceid}),a.ajax({type:'POST',data:U,url:'../../ases/managers/student_profile/studentprofile_serverproc.php',success:function success(Y){swal({title:Y.title,text:Y.msg,type:Y.type},function(){T.hide();var Z=J(document.location.search);Z.tab?location.reload():location.href=location.search+'&tab=socioed_tab'})},dataType:'json',cache:'false',error:function error(Y){console.log(Y)}})}}function I(S){var T=/^\d{4}\-(0?[1-9]|1[012])\-(0?[1-9]|[12][0-9]|3[01])$/,U=T.exec(S[1].value);return console.log(T.exec(S[1].value)),''==S[1].value?'Debe introducir la fecha en la cual se realiz\xF3 el seguimiento':null===U?'La fecha no sigue el patr\xF3n yyyy-mm-dd. Ejemplo 2017-10-13':''==S[2].value?'Debe introducir el lugar donde se realiz\xF3 el seguimiento':''==S[7].value?'El campo tema se encuentra vacio':''==S[8].value?'El campo objetivos se encuentra vacio':parseInt(S[5].value)<parseInt(S[3].value)?'La hora de finalizaci\xF3n debe ser mayor a la hora inicial':parseInt(S[3].value)==parseInt(S[5].value)&&parseInt(S[6].value)<=parseInt(S[4].value)?'La hora de finalizaci\xF3n debe ser mayor a la hora inicial':''!=S[9].value&&0==S[10].value?'El riesgo asociado al campo Actividad Invidual no est\xE1 marcado. Si usted escribi\xF3 informaci\xF3n en el campo Actividad Individual debe marcar un nivel de riesgo.':''!=S[11].value&&0==S[12].value?'El riesgo asociado al campo Actividad Familiar no est\xE1 marcado. Si usted escribi\xF3 informaci\xF3n en el campo Actividad Familiar debe marcar un nivel de riesgo.':''!=S[13].value&&0==S[14].value?'El riesgo asociado al campo Actividad Acad\xE9mico no est\xE1 marcado. Si usted escribi\xF3 informaci\xF3n en el campo Actividad Acad\xE9mico debe marcar un nivel de riesgo.':''!=S[15].value&&0==S[16].value?'El riesgo asociado al campo Actividad Econ\xF3mico no est\xE1 marcado. Si usted escribi\xF3 informaci\xF3n en el campo Actividad Econ\xF3mico debe marcar un nivel de riesgo.':''!=S[17].value&&0==S[18].value?'El riesgo asociado al campo Actividad Vida Universitaria no est\xE1 marcado. Si usted escribi\xF3 informaci\xF3n en el campo Actividad Vida Universitaria debe marcar un nivel de riesgo.':''==S[9].value&&0!=S[10].value?'Usted ha marcado el nivel de riesgo asociado a la actividad Individual, debe digitar informaci\xF3n en el campo Actividad Individual. O puede utilizar el icono (<span style=\'color:gray;\' class=\'glyphicon glyphicon-erase\'></span>) de limpiar riesgo.':''==S[11].value&&0!=S[12].value?'Usted ha marcado el nivel de riesgo asociado a la actividad Familiar, debe digitar informaci\xF3n en el campo Actividad Familiar. O puede utilizar el icono (<span style=\'color:gray;\' class=\'glyphicon glyphicon-erase\'></span>) de limpiar riesgo.':''==S[13].value&&0!=S[14].value?'Usted ha marcado el nivel de riesgo asociado a la actividad Acad\xE9mico, debe digitar informaci\xF3n en el campo Actividad Acad\xE9mico. O puede utilizar el icono (<span style=\'color:gray;\' class=\'glyphicon glyphicon-erase\'></span>) de limpiar riesgo.':''==S[15].value&&0!=S[16].value?'Usted ha marcado el nivel de riesgo asociado a la actividad Econ\xF3mico, debe digitar informaci\xF3n en el campo Actividad Econ\xF3mico. O puede utilizar el icono (<span style=\'color:gray;\' class=\'glyphicon glyphicon-erase\'></span>) de limpiar riesgo.':''==S[17].value&&0!=S[18].value?'Usted ha marcado el nivel de riesgo asociado a la actividad Vida Universitaria, debe digitar informaci\xF3n en el campo Actividad Vida Universitaria. O puede utilizar el icono (<span style=\'color:gray;\' class=\'glyphicon glyphicon-erase\'></span>) de limpiar riesgo.':'success'}function J(){for(var X,T=[],U=document.location.search.substring(1),V=U.split('&'),W=0;W<V.length;W++)X=V[W].split('='),T[X[0]]=X[1];return T}function K(S){G();var T=new Date(a('#'+S+' .date_tracking_peer').text()),U=a('#'+S+' .place_tracking_peer').text(),V=a('#'+S+' .init_time_tracking_peer').text(),W=a('#'+S+' .ending_time_tracking_peer').text(),X=a('#'+S+' .topic_tracking_peer').text(),Y=a('#'+S+' .objectives_tracking_peer').text(),Z=a('#'+S+' .individual_tracking_peer').text(),_=a('#'+S+' .ind_risk_tracking_peer').text(),aa=a('#'+S+' .familiar_tracking_peer').text(),ba=a('#'+S+' .fam_risk_tracking_peer').text(),ca=a('#'+S+' .academico_tracking_peer').text(),da=a('#'+S+' .aca_risk_tracking_peer').text(),ea=a('#'+S+' .economico_tracking_peer').text(),fa=a('#'+S+' .econ_risk_tracking_peer').text(),ga=a('#'+S+' .lifeu_tracking_peer').text(),ha=a('#'+S+' .lifeu_risk_tracking_peer').text(),ia=a('#'+S+' .observations_tracking_peer').text(),ja={};ja.bajo=1,ja.medio=2,ja.alto=3;var ka=T.getFullYear(),la=T.getMonth()+1;ka+=10>T.getMonth()?'-0'+la:'-'+la,ka+=10>T.getDate()?'-0'+T.getDate():'-'+T.getDate();var ma=V.substring(0,2),na=V.substring(3,5),oa=W.substring(0,2),pa=W.substring(3,5);a('#h_ini option[value="'+ma+'"]').attr('selected',!0),a('#m_ini option[value="'+na+'"]').attr('selected',!0),a('#h_fin option[value="'+oa+'"]').attr('selected',!0),a('#m_fin option[value="'+pa+'"]').attr('selected',!0);var qa=ja[_.toLowerCase()],ra=ja[ba.toLowerCase()],sa=ja[fa.toLowerCase()],ta=ja[da.toLowerCase()],ua=ja[ha.toLowerCase()];''==_?a('input[name=\'riesgo_ind\'][value=\'0\']').prop('checked',!0):a('input[name=\'riesgo_ind\'][value=\''+qa+'\']').prop('checked',!0),''==ba?a('input[name=\'riesgo_familiar\'][value=\'0\']').prop('checked',!0):a('input[name=\'riesgo_familiar\'][value=\''+ra+'\']').prop('checked',!0),''==fa?a('input[name=\'riesgo_econom\'][value=\'0\']').prop('checked',!0):a('input[name=\'riesgo_econom\'][value=\''+sa+'\']').prop('checked',!0),''==da?a('input[name=\'riesgo_aca\'][value=\'0\']').prop('checked',!0):a('input[name=\'riesgo_aca\'][value=\''+ta+'\']').prop('checked',!0),''==ha?a('input[name=\'riesgo_uni\'][value=\'0\']').prop('checked',!0):a('input[name=\'riesgo_uni\'][value=\''+ua+'\']').prop('checked',!0),a('#date').val(ka),a('#place').val(U),a('#topic_textarea').val(X),a('#objetivos').val(Y),a('#individual').val(Z),a('#familiar').val(aa),a('#academico').val(ca),a('#economico').val(ea),a('#vida_uni').val(ga),a('#observaciones').val(ia),a('#id_tracking_peer').val(S);var va=a('#modal_peer_tracking');va.show()}function L(S){a.ajax({type:'POST',data:{func:'delete_tracking_peer',id_tracking:S},url:'../managers/student_profile/studentprofile_serverproc.php',success:function success(T){swal(T.title,T.msg,T.status);var U=J(document.location.search);U.tab?location.reload():location.href=location.search+'&tab=socioed_tab'},dataType:'json',cache:'false',error:function error(T){swal(T.title,T.msg,T.status)}})}function O(S){a.ajax({type:'POST',data:{func:'is_student',code_student:S},url:'../managers/student_profile/studentprofile_serverproc.php',success:function success(T){if(console.log(T),'1'==T){var U=J(document.location.search),V=document.location+'',W=V.split('?'),X=W[0]+'?courseid='+U.courseid+'&instanceid='+U.instanceid+'&student_code='+S;location.href=X}else swal('Error','No se encuentra un estudiante asociado al c\xF3digo ingresado','error')},dataType:'text',cache:'false',error:function error(T){console.log(T),swal('Error','Error al comunicarse con el servidor, por favor intentelo nuevamente.','error')}})}function P(){for(var S=0;S<Object.keys(datos.informacion).length;S++){var T=[],U,V=[],W=[],X=[];U=datos.informacion[S].dimension;for(var Y=0;'false'==datos.informacion[S].datos[Y].end;)V.push(datos.informacion[S].datos[Y].fecha),W.push(datos.informacion[S].datos[Y].color),X.push(datos.informacion[S].datos[Y].riesgo),++Y;T.push(U),T.push(V),T.push(W),T.push(X),datosGraficables.push(T)}}function Q(){P();var S=R(datosGraficables[0],ctx_individual),T=R(datosGraficables[1],ctx_familiar),U=R(datosGraficables[2],ctx_academico),V=R(datosGraficables[3],ctx_economico),W=R(datosGraficables[4],ctx_vida_universitaria)}function R(S,T){return new Chart(T,{type:'line',data:{labels:S[1],datasets:[{label:'Nivel de riesgo',fill:!1,lineTension:0,pointBackgroundColor:S[2],data:S[3],backgroundColor:'black',borderColor:'black',borderWidth:3,pointRadius:5,pointHoverRadius:7}]},options:{legend:{display:!1},scales:{yAxes:[{ticks:{beginAtZero:!0,stepSize:1,max:3,min:0}}]}}})}return{init:function init(){var S=J(document.location.search),T=a('.panel-collapse.collapse.in');switch(S.tab){case'socioed_tab':a('#general_li').removeClass('active'),a('#socioed_li').addClass('active'),a('#general_tab').removeClass('active'),a('#socioed_tab').addClass('active'),T.removeClass('in'),a('#collapseOne').addClass('in');break;default:T.removeClass('in');}a('#asignados').select2({language:{noResults:function noResults(){return'No hay resultado'},searching:function searching(){return'Buscando..'}},dropdownAutoWidth:!0}),a('#search').on('click',function(){var W=a('#asignados').val(),X=W.split('-')[0];O(X)});var U=a('#modal_peer_tracking');l(),n(),v(),A(),D(),E(),F(),a('#save').click(function(){p()}),a('#cancel').click(function(){swal({title:'\xBFEstas seguro/a de cancelar?',text:'Los cambios realizados no ser\xE1n tomados en cuenta y se perder\xE1n',type:'warning',showCancelButton:!0,confirmButtonColor:'#d51b23',confirmButtonText:'Si!',cancelButtonText:'No',closeOnConfirm:!0},function(W){W&&m()})}),a('#button_add_track').on('click',function(){a('#save_seg').removeClass('hide'),a('#div_created').addClass('hide'),a('#upd_seg').addClass('hide'),a('#myModalLabel').attr('name','PARES'),U.show(),G()}),a('#save_tracking_btn').on('click',function(){H()}),a('#clean_individual_risk').on('click',function(){a('#no_value_individual').prop('checked',!0)}),a('#clean_familiar_risk').on('click',function(){a('#no_value_familiar').prop('checked',!0)}),a('#clean_academic_risk').on('click',function(){a('#no_value_academic').prop('checked',!0)}),a('#clean_economic_risk').on('click',function(){a('#no_value_economic').prop('checked',!0)}),a('#clean_life_risk').on('click',function(){a('#no_value_life').prop('checked',!0)}),a('.btn-primary.edit_peer_tracking').on('click',function(){var W=a(this).attr('id'),X=W.substring(14);K(X)}),a('.btn-danger.delete_peer_tracking').on('click',function(){var W=a(this).attr('id'),X=W.substring(21);swal({title:'Advertencia',text:'\xBFEst\xE1 seguro(a) que desea borrar este seguimiento?',type:'warning',showCancelButton:!0,confirmButtonText:'Si',cancelButtonText:'No',closeOnConfirm:!1},function(Y){Y&&L(X)})});var V={draw:function draw(W,X,Y){var Z={radius:5,w:600,h:600,factor:1,factorLegend:.85,levels:3,maxValue:0,radians:2*Math.PI,opacityArea:0.5,ToRight:5,TranslateX:80,TranslateY:30,ExtraWidthX:100,ExtraWidthY:100,color:c.scale.category10()};if('undefined'!=typeof Y)for(var _ in Y)'undefined'!=typeof Y[_]&&(Z[_]=Y[_]);Z.maxValue=Math.max(Z.maxValue,c.max(X,function(ja){return c.max(ja.map(function(ka){return ka.value}))}));var aa=X[0].map(function(ja){return ja.axis}),ba=aa.length,ca=Z.factor*Math.min(Z.w/2,Z.h/2),da=c.format('');c.select(W).select('svg').remove();var ea=c.select(W).append('svg').attr('width',Z.w+Z.ExtraWidthX).attr('height',Z.h+Z.ExtraWidthY).append('g').attr('transform','translate('+Z.TranslateX+','+Z.TranslateY+')');for(var fa,ha,ga=0;ga<Z.levels-1;ga++)ha=Z.factor*ca*((ga+1)/Z.levels),ea.selectAll('.levels').data(aa).enter().append('svg:line').attr('x1',function(ja,ka){return ha*(1-Z.factor*Math.sin(ka*Z.radians/ba))}).attr('y1',function(ja,ka){return ha*(1-Z.factor*Math.cos(ka*Z.radians/ba))}).attr('x2',function(ja,ka){return ha*(1-Z.factor*Math.sin((ka+1)*Z.radians/ba))}).attr('y2',function(ja,ka){return ha*(1-Z.factor*Math.cos((ka+1)*Z.radians/ba))}).attr('class','line').style('stroke','grey').style('stroke-opacity','0.75').style('stroke-width','0.3px').attr('transform','translate('+(Z.w/2-ha)+', '+(Z.h/2-ha)+')');for(var ha,ga=0;ga<Z.levels;ga++)ha=Z.factor*ca*((ga+1)/Z.levels),ea.selectAll('.levels').data([1]).enter().append('svg:text').attr('x',function(){return ha*(1-Z.factor*Math.sin(0))}).attr('y',function(){return ha*(1-Z.factor*Math.cos(0))}).attr('class','legend').style('font-family','sans-serif').style('font-size','10px').attr('transform','translate('+(Z.w/2-ha+Z.ToRight)+', '+(Z.h/2-ha)+')').attr('fill','#737373').text(da((ga+1)*Z.maxValue/Z.levels));series=0;var ia=ea.selectAll('.axis').data(aa).enter().append('g').attr('class','axis');ia.append('line').attr('x1',Z.w/2).attr('y1',Z.h/2).attr('x2',function(ja,ka){return Z.w/2*(1-Z.factor*Math.sin(ka*Z.radians/ba))}).attr('y2',function(ja,ka){return Z.h/2*(1-Z.factor*Math.cos(ka*Z.radians/ba))}).attr('class','line').style('stroke','grey').style('stroke-width','1px'),ia.append('text').attr('class','legend').text(function(ja){return ja}).style('font-family','sans-serif').style('font-size','11px').attr('text-anchor','middle').attr('dy','1.5em').attr('transform',function(){return'translate(0, -10)'}).attr('x',function(ja,ka){return Z.w/2*(1-Z.factorLegend*Math.sin(ka*Z.radians/ba))-60*Math.sin(ka*Z.radians/ba)}).attr('y',function(ja,ka){return Z.h/2*(1-Math.cos(ka*Z.radians/ba))-20*Math.cos(ka*Z.radians/ba)}),X.forEach(function(ja){dataValues=[],ea.selectAll('.nodes').data(ja,function(la,ma){dataValues.push([Z.w/2*(1-parseFloat(Math.max(la.value,0))/Z.maxValue*Z.factor*Math.sin(ma*Z.radians/ba)),Z.h/2*(1-parseFloat(Math.max(la.value,0))/Z.maxValue*Z.factor*Math.cos(ma*Z.radians/ba))])}),dataValues.push(dataValues[0]),ea.selectAll('.area').data([dataValues]).enter().append('polygon').attr('class','radar-chart-serie'+series).style('stroke-width','2px').style('stroke',Z.color(series)).attr('points',function(la){for(var ma='',na=0;na<la.length;na++)ma=ma+la[na][0]+','+la[na][1]+' ';return ma}).style('fill',function(){return Z.color(series)}).style('fill-opacity',Z.opacityArea).on('mouseover',function(){z='polygon.'+c.select(this).attr('class'),ea.selectAll('polygon').transition(200).style('fill-opacity',0.1),ea.selectAll(z).transition(200).style('fill-opacity',.7)}).on('mouseout',function(){ea.selectAll('polygon').transition(200).style('fill-opacity',Z.opacityArea)}),series++}),series=0,X.forEach(function(ja){ea.selectAll('.nodes').data(ja).enter().append('svg:circle').attr('class','radar-chart-serie'+series).attr('r',Z.radius).attr('alt',function(la){return Math.max(la.value,0)}).attr('cx',function(la,ma){return dataValues.push([Z.w/2*(1-parseFloat(Math.max(la.value,0))/Z.maxValue*Z.factor*Math.sin(ma*Z.radians/ba)),Z.h/2*(1-parseFloat(Math.max(la.value,0))/Z.maxValue*Z.factor*Math.cos(ma*Z.radians/ba))]),Z.w/2*(1-Math.max(la.value,0)/Z.maxValue*Z.factor*Math.sin(ma*Z.radians/ba))}).attr('cy',function(la,ma){return Z.h/2*(1-Math.max(la.value,0)/Z.maxValue*Z.factor*Math.cos(ma*Z.radians/ba))}).attr('data-id',function(la){return la.axis}).style('fill',Z.color(series)).style('fill-opacity',.9).on('mouseover',function(la){newX=parseFloat(c.select(this).attr('cx'))-10,newY=parseFloat(c.select(this).attr('cy'))-5,fa.attr('x',newX).attr('y',newY).text(da(la.value)).transition(200).style('opacity',1),z='polygon.'+c.select(this).attr('class'),ea.selectAll('polygon').transition(200).style('fill-opacity',0.1),ea.selectAll(z).transition(200).style('fill-opacity',.7)}).on('mouseout',function(){fa.transition(200).style('opacity',0),ea.selectAll('polygon').transition(200).style('fill-opacity',Z.opacityArea)}).append('svg:title').text(function(la){return Math.max(la.value,0)}),series++}),fa=ea.append('text').style('opacity',0).style('font-family','sans-serif').style('font-size','13px')}};a('#view_graphic_button').on('click',function(){var W={};W.div_no_risk=0,W.div_high_risk=1,W.div_medium_risk=2,W.div_low_risk=3;var X=document.getElementById('individual_risk').className.split(/\s+/),Y=document.getElementById('familiar_risk').className.split(/\s+/),Z=document.getElementById('academic_risk').className.split(/\s+/),_=document.getElementById('economic_risk').className.split(/\s+/),aa=document.getElementById('life_risk').className.split(/\s+/),ba=document.getElementById('geo_risk').className.split(/\s+/),ca=W[X[0]],da=W[Y[0]],ea=W[_[0]],fa=W[Z[0]],ga=W[aa[0]],ha=W[ba[0]],ia=500,ja=500,ka=c.scale.category10();V.draw('#modal_risk_body',[[{axis:'Individual',value:ca},{axis:'Econ\xF3mico',value:ea},{axis:'Familiar',value:da},{axis:'Vida Universitaria',value:1},{axis:'Acad\xE9mico',value:fa},{axis:'Geogr\xE1fico',value:ha}]],{w:ia,h:ja,maxValue:3,levels:3,ExtraWidthX:300});c.select('#body').selectAll('svg').append('svg').attr('width',ia+300).attr('height',ja);a('#modal_risk_graph').show()}),a('#view_graphic_risk_button').click(function(){a('#modal_riesgos').fadeIn(200),Q()}),a('#mymodal-riesgo-close').click(function(){a('#modal_riesgos').fadeOut(200)})}}});