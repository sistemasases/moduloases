define(["jquery","block_ases/bootstrap","block_ases/d3","block_ases/sweetalert","block_ases/jqueryui","block_ases/select2","block_ases/Chart"],function(a,b,c,d){function e(){a("#editar_ficha").click(function(){a("#ficha_estudiante").find("input").prop("readonly",!1),a("#observations_profile").prop("readonly",!1),a("#profesional_ps").prop("readonly",!0),a("#practicante_ps").prop("readonly",!0),a("#monitor_ps").prop("readonly",!0),a("#ficha_estudiante").find("select").prop("disabled",!1),a(this).hide(),a("#ficha_estudiante #cancel").fadeIn(),a("#ficha_estudiante #save").fadeIn(),a("#ficha_estudiante #codigo").attr("readonly",!0),a("#ficha_estudiante #search").fadeOut()})}function f(){a("#ficha_estudiante").find("input, textarea").prop("readonly",!0),a("#ficha_estudiante").find("select").prop("disabled",!0),a(this).hide(),a("#ficha_estudiante #save").fadeOut(),a("#ficha_estudiante #cancel").fadeOut(),a("#ficha_estudiante #editar_ficha").fadeIn(),a("#ficha_estudiante #codigo").attr("readonly",!1),a("#ficha_estudiante #search").fadeIn()}function g(){var b=a("#ficha_estudiante").serializeArray();if(h(b)){JSON.stringify(b);a.ajax({type:"POST",data:{func:"save_profile",form:b},url:"../managers/student_profile/studentprofile_serverproc.php",success:function(a){swal(a.title,a.msg,a.status)},dataType:"json",cache:"false",error:function(a){swal(a.title,a.msg,a.status)}})}f()}function h(a){return j(a[4].value)?(swal("Error",'El campo "Documento" solo debe contener números',"error"),0):""==a[4].value?(swal("Error",'El campo "Documento" no puede estar vacio',"error"),0):""==a[3].value?(swal("Error",'El campo "Tipo de documento" no puede estar vacio',"error"),0):j(a[6].value)?(swal("Error",'El campo "Teléfono 1" solo debe contener números',"error"),0):j(a[7].value)?(swal("Error",'El campo "Teléfono 2" solo debe contener números',"error"),0):j(a[8].value)?(swal("Error",'El campo "Teléfono 3" solo debe contener números',"error"),0):""==a[9].value?(swal("Error",'El campo "Email alternativo" no puede estar vacio',"error"),0):k(a[9].value)?(swal("Error","El formato del correo alternativo es incorrecto. \n El formato correcto debería ser ejemplo@ejemplo.com","error"),0):""==a[10].value?(swal("Error",'El campo "Nombre acudiente" no puede estar vacio',"error"),0):j(a[11].value)?(swal("Error",'El campo "Teléfono acudiente" solo debe contener números',"error"),0):1}function j(a){var b="abcdefghyjklmnñopqrstuvwxyz";for(a=a.toLowerCase(),i=0;i<a.length;i++)if(b.indexOf(a.charAt(i),0)!=-1)return 1;return 0}function k(a){var b=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;return b.test(a)?0:1}function l(){var b=a("#modal_dropout"),c=a(".mymodal-close"),d=a("#goback_backdrop");d.on("click",function(){b.hide()}),c.on("click",function(){b.hide()})}function m(){var b=a("#modal_peer_tracking"),c=a(".mymodal-close"),d=a("#cancel_peer_tracking");d.on("click",function(){b.hide()}),c.on("click",function(){b.hide()});var e=a(".panel-heading.heading_semester_tracking");e.on("click",function(){"collapsed"==a(this).parent().attr("class")?(a("h4>span",this).removeClass("glyphicon-chevron-left"),a("h4>span",this).addClass("glyphicon-chevron-down")):(a("h4>span",this).removeClass("glyphicon-chevron-down"),a("h4>span",this).addClass("glyphicon-chevron-left"))})}function n(){var b=a("#modal_risk_span"),c=a("#modal_risk_close");b.on("click",function(){a("#modal_risk_graph").hide()}),c.on("click",function(){a("#modal_risk_graph").hide()})}function o(){a("#date").datepicker({dateFormat:"yy-mm-dd"});for(var b=new Date,c=(b.getDate(),b.getMonth()+1,b.getFullYear(),b.getMinutes()),d=b.getHours(),e="",f=0;f<24;f++)f==d?(d<10&&(d="0"+d),e+='<option value="'+d+'" selected>'+d+"</option>"):e+=f<10?'<option value="0'+f+'">0'+f+"</option>":'<option value="'+f+'">'+f+"</option>";for(var g="",f=0;f<60;f++)f==c?(c<10&&(c="0"+c),g+='<option value="'+c+'" selected>'+c+"</option>"):g+=f<10?'<option value="0'+f+'">0'+f+"</option>":'<option value="'+f+'">'+f+"</option>";a("#h_ini").append(e),a("#m_ini").append(g),a("#h_fin").append(e),a("#m_fin").append(g),a("#infomonitor").addClass("hide"),a("#seguimiento").find("input:text, textarea").val(""),a("#seguimiento").find("input:radio,input:checkbox").prop("checked",!1),a("#upd_seg").attr("disabled",!1),a("#upd_seg").attr("title",""),a("#seguimiento").find("select, textarea, input").attr("disabled",!1),a("#no_value_individual").hide(),a("#no_value_familiar").hide(),a("#no_value_academic").hide(),a("#no_value_economic").hide(),a("#no_value_life").hide(),a("#id_tracking_peer").val(""),a("#place").val(""),a("#topic_textarea").val(""),a("#objetivos").val(""),a("#individual").val(""),a("#familiar").val(""),a("#academico").val(""),a("#economico").val(""),a("#vida_uni").val(""),a("#observaciones").val(""),a("#no_value_individual").prop("checked",!0),a("#no_value_familiar").prop("checked",!0),a("#no_value_academic").prop("checked",!0),a("#no_value_economic").prop("checked",!0),a("#no_value_life").prop("checked",!0)}function p(){var b=a("#tracking_peer_form"),c=a("#modal_peer_tracking"),d=b.serializeArray(),e=r(document.location.search),f=q(d);if("success"!=f)swal({title:"Advertencia",text:f,type:"warning",html:!0});else{d.push({name:"func",value:"save_tracking_peer"});var g=a("#id_ases").val();d.push({name:"id_ases",value:g}),d.push({name:"id_instance",value:e.instanceid}),a.ajax({type:"POST",data:d,url:"../../ases/managers/student_profile/studentprofile_serverproc.php",success:function(a){swal({title:a.title,text:a.msg,type:a.type},function(){c.hide();var a=r(document.location.search);a.tab?location.reload():location.href=location.search+"&tab=socioed_tab"})},dataType:"json",cache:"false",error:function(a){console.log(a)}})}}function q(a){var b=/^\d{4}\-(0?[1-9]|1[012])\-(0?[1-9]|[12][0-9]|3[01])$/,c=b.exec(a[1].value);return""==a[1].value?"Debe introducir la fecha en la cual se realizó el seguimiento":null===c?"La fecha no sigue el patrón yyyy-mm-dd. Ejemplo 2017-10-13":""==a[2].value?"Debe introducir el lugar donde se realizó el seguimiento":""==a[7].value?"El campo tema se encuentra vacio":""==a[8].value?"El campo objetivos se encuentra vacio":parseInt(a[5].value)<parseInt(a[3].value)?"La hora de finalización debe ser mayor a la hora inicial":parseInt(a[3].value)==parseInt(a[5].value)&&parseInt(a[6].value)<=parseInt(a[4].value)?"La hora de finalización debe ser mayor a la hora inicial":""!=a[9].value&&0==a[10].value?"El riesgo asociado al campo Actividad Invidual no está marcado. Si usted escribió información en el campo Actividad Individual debe marcar un nivel de riesgo.":""!=a[11].value&&0==a[12].value?"El riesgo asociado al campo Actividad Familiar no está marcado. Si usted escribió información en el campo Actividad Familiar debe marcar un nivel de riesgo.":""!=a[13].value&&0==a[14].value?"El riesgo asociado al campo Actividad Académico no está marcado. Si usted escribió información en el campo Actividad Académico debe marcar un nivel de riesgo.":""!=a[15].value&&0==a[16].value?"El riesgo asociado al campo Actividad Económico no está marcado. Si usted escribió información en el campo Actividad Económico debe marcar un nivel de riesgo.":""!=a[17].value&&0==a[18].value?"El riesgo asociado al campo Actividad Vida Universitaria no está marcado. Si usted escribió información en el campo Actividad Vida Universitaria debe marcar un nivel de riesgo.":""==a[9].value&&0!=a[10].value?"Usted ha marcado el nivel de riesgo asociado a la actividad Individual, debe digitar información en el campo Actividad Individual. O puede utilizar el icono (<span style='color:gray;' class='glyphicon glyphicon-erase'></span>) de limpiar riesgo.":""==a[11].value&&0!=a[12].value?"Usted ha marcado el nivel de riesgo asociado a la actividad Familiar, debe digitar información en el campo Actividad Familiar. O puede utilizar el icono (<span style='color:gray;' class='glyphicon glyphicon-erase'></span>) de limpiar riesgo.":""==a[13].value&&0!=a[14].value?"Usted ha marcado el nivel de riesgo asociado a la actividad Académico, debe digitar información en el campo Actividad Académico. O puede utilizar el icono (<span style='color:gray;' class='glyphicon glyphicon-erase'></span>) de limpiar riesgo.":""==a[15].value&&0!=a[16].value?"Usted ha marcado el nivel de riesgo asociado a la actividad Económico, debe digitar información en el campo Actividad Económico. O puede utilizar el icono (<span style='color:gray;' class='glyphicon glyphicon-erase'></span>) de limpiar riesgo.":""==a[17].value&&0!=a[18].value?"Usted ha marcado el nivel de riesgo asociado a la actividad Vida Universitaria, debe digitar información en el campo Actividad Vida Universitaria. O puede utilizar el icono (<span style='color:gray;' class='glyphicon glyphicon-erase'></span>) de limpiar riesgo.":"success"}function r(a){for(var b=[],c=document.location.search.substring(1),d=c.split("&"),e=0;e<d.length;e++){var f=d[e].split("=");b[f[0]]=f[1]}return b}function s(b){o();var c=new Date(a("#"+b+" .date_tracking_peer").text()),d=a("#"+b+" .place_tracking_peer").text(),e=a("#"+b+" .init_time_tracking_peer").text(),f=a("#"+b+" .ending_time_tracking_peer").text(),g=a("#"+b+" .topic_tracking_peer").text(),h=a("#"+b+" .objectives_tracking_peer").text(),i=a("#"+b+" .individual_tracking_peer").text(),j=a("#"+b+" .ind_risk_tracking_peer").text(),k=a("#"+b+" .familiar_tracking_peer").text(),l=a("#"+b+" .fam_risk_tracking_peer").text(),m=a("#"+b+" .academico_tracking_peer").text(),n=a("#"+b+" .aca_risk_tracking_peer").text(),p=a("#"+b+" .economico_tracking_peer").text(),q=a("#"+b+" .econ_risk_tracking_peer").text(),r=a("#"+b+" .lifeu_tracking_peer").text(),s=a("#"+b+" .lifeu_risk_tracking_peer").text(),t=a("#"+b+" .observations_tracking_peer").text(),u=new Object;u.bajo=1,u.medio=2,u.alto=3;var v=c.getFullYear(),w=c.getMonth()+1;v+=c.getMonth()<10?"-0"+w:"-"+w,v+=c.getDate()<10?"-0"+c.getDate():"-"+c.getDate();var x=e.substring(0,2),y=e.substring(3,5),z=f.substring(0,2),A=f.substring(3,5);a('#h_ini option[value="'+x+'"]').attr("selected",!0),a('#m_ini option[value="'+y+'"]').attr("selected",!0),a('#h_fin option[value="'+z+'"]').attr("selected",!0),a('#m_fin option[value="'+A+'"]').attr("selected",!0);var B=u[j.toLowerCase()],C=u[l.toLowerCase()],D=u[q.toLowerCase()],E=u[n.toLowerCase()],F=u[s.toLowerCase()];""!=j?a("input[name='riesgo_ind'][value='"+B+"']").prop("checked",!0):a("input[name='riesgo_ind'][value='0']").prop("checked",!0),""!=l?a("input[name='riesgo_familiar'][value='"+C+"']").prop("checked",!0):a("input[name='riesgo_familiar'][value='0']").prop("checked",!0),""!=q?a("input[name='riesgo_econom'][value='"+D+"']").prop("checked",!0):a("input[name='riesgo_econom'][value='0']").prop("checked",!0),""!=n?a("input[name='riesgo_aca'][value='"+E+"']").prop("checked",!0):a("input[name='riesgo_aca'][value='0']").prop("checked",!0),""!=s?a("input[name='riesgo_uni'][value='"+F+"']").prop("checked",!0):a("input[name='riesgo_uni'][value='0']").prop("checked",!0),a("#date").val(v),a("#place").val(d),a("#topic_textarea").val(g),a("#objetivos").val(h),a("#individual").val(i),a("#familiar").val(k),a("#academico").val(m),a("#economico").val(p),a("#vida_uni").val(r),a("#observaciones").val(t),a("#id_tracking_peer").val(b);var G=a("#modal_peer_tracking");G.show()}function t(b){a.ajax({type:"POST",data:{func:"delete_tracking_peer",id_tracking:b},url:"../managers/student_profile/studentprofile_serverproc.php",success:function(a){swal(a.title,a.msg,a.status);var b=r(document.location.search);b.tab?location.reload():location.href=location.search+"&tab=socioed_tab"},dataType:"json",cache:"false",error:function(a){swal(a.title,a.msg,a.status)}})}function u(b){a.ajax({type:"POST",data:{func:"is_student",code_student:b},url:"../managers/student_profile/studentprofile_serverproc.php",success:function(a){if("1"==a){var c=r(document.location.search),d=String(document.location),e=d.split("?"),f=e[0]+"?courseid="+c.courseid+"&instanceid="+c.instanceid+"&student_code="+b;location.href=f}else swal("Error","No se encuentra un estudiante asociado al código ingresado","error")},dataType:"text",cache:"false",error:function(a){swal("Error","Error al comunicarse con el servidor, por favor intentelo nuevamente.","error")}})}function v(){for(var a=0;a<Object.keys(datos.informacion).length;a++){var b,c=[],d=[],e=[],f=[];b=datos.informacion[a].dimension;for(var g=0;"false"==datos.informacion[a].datos[g].end;)d.push(datos.informacion[a].datos[g].fecha),e.push(datos.informacion[a].datos[g].color),f.push(datos.informacion[a].datos[g].riesgo),g+=1;c.push(b),c.push(d),c.push(e),c.push(f),datosGraficables.push(c)}}function w(){v();x(datosGraficables[0],ctx_individual),x(datosGraficables[1],ctx_familiar),x(datosGraficables[2],ctx_academico),x(datosGraficables[3],ctx_economico),x(datosGraficables[4],ctx_vida_universitaria)}function x(a,b,c){return new Chart(b,{type:"line",data:{labels:a[1],datasets:[{label:"Nivel de riesgo",fill:!1,lineTension:0,pointBackgroundColor:a[2],data:a[3],backgroundColor:"black",borderColor:"black",borderWidth:3,pointRadius:5,pointHoverRadius:7}]},options:{legend:{display:!1},scales:{yAxes:[{ticks:{beginAtZero:!0,stepSize:1,max:3,min:0}}]}}})}return{init:function(b){var d=r(document.location.search),h=a(".panel-collapse.collapse.in"),i=this;a("#asignados").select2({width:"resolve",height:"resolve",language:{noResults:function(){return"No hay resultado"},searching:function(){return"Buscando.."}}}),a("#asignados").on("change",function(){var b=a("#asignados").val(),c=b.split("-")[0];u(c)});for(var j=0,k=b.length;j<k;j++)a("#select-"+b[j].academic_program_id+" option[value="+b[j].program_status+"]").attr("selected",!0),"ACTIVO"==b[j].program_status&&a("#tr-"+b[j].id_moodle_user).addClass("is-active"),"1"==b[j].tracking_status&&a("#div_flags_"+b[j].academic_program_id).prop("checked",!0);var q="";a("div.slider.round").click(function(a){q=a.target.parentElement.children[0].checked}),a(".input-tracking").on("change",{current_tracking_status:q},function(){i.update_tracking_status(q,a(this),b,i)});var v="";switch(a(".select_statuses_program").on("focus",function(a){v=a.target.value}),a(".select_statuses_program").on("change",{current_status:v},function(){i.update_status_program(v,a(this))}),a("#icon-tracking").on("click",function(){i.update_status_ases(d)}),d.tab){case"socioed_tab":a("#general_li").removeClass("active"),a("#socioed_li").addClass("active"),a("#general_tab").removeClass("active"),a("#socioed_tab").addClass("active"),h.removeClass("in"),a("#collapseOne").addClass("in");break;default:h.removeClass("in")}var x=a("#modal_peer_tracking");e(),l(),m(),n(),a("#save").click(function(){g()}),a("#cancel").click(function(){swal({title:"¿Estas seguro/a de cancelar?",text:"Los cambios realizados no serán tomados en cuenta y se perderán",type:"warning",showCancelButton:!0,confirmButtonColor:"#d51b23",confirmButtonText:"Si!",cancelButtonText:"No",closeOnConfirm:!0},function(a){a&&f()})}),a("#button_add_track").on("click",function(){a("#save_seg").removeClass("hide"),a("#div_created").addClass("hide"),a("#upd_seg").addClass("hide"),a("#myModalLabel").attr("name","PARES"),x.show(),o()}),a("#save_tracking_btn").on("click",function(){p()}),a("#clean_individual_risk").on("click",function(){a("#no_value_individual").prop("checked",!0)}),a("#clean_familiar_risk").on("click",function(){a("#no_value_familiar").prop("checked",!0)}),a("#clean_academic_risk").on("click",function(){a("#no_value_academic").prop("checked",!0)}),a("#clean_economic_risk").on("click",function(){a("#no_value_economic").prop("checked",!0)}),a("#clean_life_risk").on("click",function(){a("#no_value_life").prop("checked",!0)}),a(".btn-primary.edit_peer_tracking").on("click",function(){var b=a(this).attr("id"),c=b.substring(14);s(c)}),a(".btn-danger.delete_peer_tracking").on("click",function(){var b=a(this).attr("id"),c=b.substring(21);swal({title:"Advertencia",text:"¿Está seguro(a) que desea borrar este seguimiento?",type:"warning",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No",closeOnConfirm:!1},function(a){a&&t(c)})});var y={draw:function(a,b,d){var e={radius:5,w:600,h:600,factor:1,factorLegend:.85,levels:3,maxValue:0,radians:2*Math.PI,opacityArea:.5,ToRight:5,TranslateX:80,TranslateY:30,ExtraWidthX:100,ExtraWidthY:100,color:c.scale.category10()};if("undefined"!=typeof d)for(var f in d)"undefined"!=typeof d[f]&&(e[f]=d[f]);e.maxValue=Math.max(e.maxValue,c.max(b,function(a){return c.max(a.map(function(a){return a.value}))}));var g=b[0].map(function(a,b){return a.axis}),h=g.length,i=e.factor*Math.min(e.w/2,e.h/2),j=c.format("");c.select(a).select("svg").remove();for(var k,l=c.select(a).append("svg").attr("width",e.w+e.ExtraWidthX).attr("height",e.h+e.ExtraWidthY).append("g").attr("transform","translate("+e.TranslateX+","+e.TranslateY+")"),m=0;m<e.levels-1;m++){var n=e.factor*i*((m+1)/e.levels);l.selectAll(".levels").data(g).enter().append("svg:line").attr("x1",function(a,b){return n*(1-e.factor*Math.sin(b*e.radians/h))}).attr("y1",function(a,b){return n*(1-e.factor*Math.cos(b*e.radians/h))}).attr("x2",function(a,b){return n*(1-e.factor*Math.sin((b+1)*e.radians/h))}).attr("y2",function(a,b){return n*(1-e.factor*Math.cos((b+1)*e.radians/h))}).attr("class","line").style("stroke","grey").style("stroke-opacity","0.75").style("stroke-width","0.3px").attr("transform","translate("+(e.w/2-n)+", "+(e.h/2-n)+")")}for(var m=0;m<e.levels;m++){var n=e.factor*i*((m+1)/e.levels);l.selectAll(".levels").data([1]).enter().append("svg:text").attr("x",function(a){return n*(1-e.factor*Math.sin(0))}).attr("y",function(a){return n*(1-e.factor*Math.cos(0))}).attr("class","legend").style("font-family","sans-serif").style("font-size","10px").attr("transform","translate("+(e.w/2-n+e.ToRight)+", "+(e.h/2-n)+")").attr("fill","#737373").text(j((m+1)*e.maxValue/e.levels))}series=0;var o=l.selectAll(".axis").data(g).enter().append("g").attr("class","axis");o.append("line").attr("x1",e.w/2).attr("y1",e.h/2).attr("x2",function(a,b){return e.w/2*(1-e.factor*Math.sin(b*e.radians/h))}).attr("y2",function(a,b){return e.h/2*(1-e.factor*Math.cos(b*e.radians/h))}).attr("class","line").style("stroke","grey").style("stroke-width","1px"),o.append("text").attr("class","legend").text(function(a){return a}).style("font-family","sans-serif").style("font-size","11px").attr("text-anchor","middle").attr("dy","1.5em").attr("transform",function(a,b){return"translate(0, -10)"}).attr("x",function(a,b){return e.w/2*(1-e.factorLegend*Math.sin(b*e.radians/h))-60*Math.sin(b*e.radians/h)}).attr("y",function(a,b){return e.h/2*(1-Math.cos(b*e.radians/h))-20*Math.cos(b*e.radians/h)}),b.forEach(function(a,b){dataValues=[],l.selectAll(".nodes").data(a,function(a,b){dataValues.push([e.w/2*(1-parseFloat(Math.max(a.value,0))/e.maxValue*e.factor*Math.sin(b*e.radians/h)),e.h/2*(1-parseFloat(Math.max(a.value,0))/e.maxValue*e.factor*Math.cos(b*e.radians/h))])}),dataValues.push(dataValues[0]),l.selectAll(".area").data([dataValues]).enter().append("polygon").attr("class","radar-chart-serie"+series).style("stroke-width","2px").style("stroke",e.color(series)).attr("points",function(a){for(var b="",c=0;c<a.length;c++)b=b+a[c][0]+","+a[c][1]+" ";return b}).style("fill",function(a,b){return e.color(series)}).style("fill-opacity",e.opacityArea).on("mouseover",function(a){z="polygon."+c.select(this).attr("class"),l.selectAll("polygon").transition(200).style("fill-opacity",.1),l.selectAll(z).transition(200).style("fill-opacity",.7)}).on("mouseout",function(){l.selectAll("polygon").transition(200).style("fill-opacity",e.opacityArea)}),series++}),series=0,b.forEach(function(a,b){l.selectAll(".nodes").data(a).enter().append("svg:circle").attr("class","radar-chart-serie"+series).attr("r",e.radius).attr("alt",function(a){return Math.max(a.value,0)}).attr("cx",function(a,b){return dataValues.push([e.w/2*(1-parseFloat(Math.max(a.value,0))/e.maxValue*e.factor*Math.sin(b*e.radians/h)),e.h/2*(1-parseFloat(Math.max(a.value,0))/e.maxValue*e.factor*Math.cos(b*e.radians/h))]),e.w/2*(1-Math.max(a.value,0)/e.maxValue*e.factor*Math.sin(b*e.radians/h))}).attr("cy",function(a,b){return e.h/2*(1-Math.max(a.value,0)/e.maxValue*e.factor*Math.cos(b*e.radians/h))}).attr("data-id",function(a){return a.axis}).style("fill",e.color(series)).style("fill-opacity",.9).on("mouseover",function(a){newX=parseFloat(c.select(this).attr("cx"))-10,newY=parseFloat(c.select(this).attr("cy"))-5,k.attr("x",newX).attr("y",newY).text(j(a.value)).transition(200).style("opacity",1),z="polygon."+c.select(this).attr("class"),l.selectAll("polygon").transition(200).style("fill-opacity",.1),l.selectAll(z).transition(200).style("fill-opacity",.7)}).on("mouseout",function(){k.transition(200).style("opacity",0),l.selectAll("polygon").transition(200).style("fill-opacity",e.opacityArea)}).append("svg:title").text(function(a){return Math.max(a.value,0)}),series++}),k=l.append("text").style("opacity",0).style("font-family","sans-serif").style("font-size","13px")}};a("#view_graphic_button").on("click",function(){var b=new Object;b.div_no_risk=0,b.div_high_risk=1,b.div_medium_risk=2,b.div_low_risk=3;var d=document.getElementById("individual_risk").className.split(/\s+/),e=document.getElementById("familiar_risk").className.split(/\s+/),f=document.getElementById("academic_risk").className.split(/\s+/),g=document.getElementById("economic_risk").className.split(/\s+/),h=document.getElementById("life_risk").className.split(/\s+/),i=document.getElementById("geo_risk").className.split(/\s+/),j=b[d[0]],k=b[e[0]],l=b[g[0]],m=b[f[0]],n=(b[h[0]],b[i[0]]),o=500,p=500,q=(c.scale.category10(),[[{axis:"Individual",value:j},{axis:"Económico",value:l},{axis:"Familiar",value:k},{axis:"Vida Universitaria",value:1},{axis:"Académico",value:m},{axis:"Geográfico",value:n}]]),r={w:o,h:p,maxValue:3,levels:3,ExtraWidthX:300};y.draw("#modal_risk_body",q,r);c.select("#body").selectAll("svg").append("svg").attr("width",o+300).attr("height",p);a("#modal_risk_graph").show()}),a("#view_graphic_risk_button").click(function(){a("#modal_riesgos").fadeIn(200),w()}),a("#mymodal-riesgo-close").click(function(){a("#modal_riesgos").fadeOut(200)})},equalize:function(){a(document).ready(function(){var b=a(".equalize").map(function(){return a(this).height()}).get(),c=Math.max.apply(null,b);a(".equalize").height(c)})},update_status_program:function(b,c){var d=c.attr("id").split("-")[1],e=c.val(),f=c.parent().parent().attr("id").split("-")[1],g={func:"update_status_program",program_id:d,status:e,student_id:f};swal({title:"Advertencia",text:"¿Está seguro que desea cambiar el estado del programa?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Si",cancelButtonText:"No",closeOnConfirm:!1},function(c){c?a.ajax({type:"POST",data:g,url:"../managers/student_profile/studentprofile_serverproc.php",success:function(b){"ACTIVO"==a("#select-"+g.program_id).val()?a("#tr-"+g.student_id).addClass("is-active"):a("#tr-"+g.student_id).removeClass("is-active"),swal(b.title,b.msg,b.status)},dataType:"json",cache:"false",error:function(a){swal(a.title,a.msg,a.status)}}):a("#select-"+g.program_id).val(b)})},update_status_ases:function(b){var c,d=a("#input_status_ases").val();switch(d){case"seguimiento":c="sinseguimiento";break;case"sinseguimiento":c="seguimiento";break;case"noasignado":c="seguimiento"}if("sinseguimiento"==d)swal("Advertencia","No es posible realizar esta acción. Al estudiante se le realiza seguimiento desde otra instancia.","warning");else{var e={func:"update_status_ases",current_status:d,new_status:c,instance_id:b.instanceid,code_student:b.student_code};swal({title:"Advertencia",text:"¿Está seguro que desea cambiar el estado de seguimiento del estudiante en esta instancia? El estado pasará de '"+d+"' a '"+c+"'",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Si",cancelButtonText:"No"},function(b){b&&("sinseguimiento"==c?(modal_dropout=a("#modal_dropout"),modal_dropout.show(),a("#save_changes_dropout").on("click",function(){e.id_reason_dropout=a("#reasons_select").val(),e.observation=a("#description_dropout").val(),a.ajax({type:"POST",data:e,url:"../managers/student_profile/studentprofile_serverproc.php",success:function(b){d=c,a("#input_status_ases").val(c),"seguimiento"==b.previous_status?(a("#icon-tracking").removeClass("i-tracking-t"),a("#icon-tracking").addClass("i-tracking-n"),a("#tip_ases_status").html("Se realiza seguimiento en otra instancia")):"sinseguimiento"==b.previous_status?(a("#icon-tracking").removeClass("i-tracking-f"),a("#icon-tracking").addClass("i-tracking-t"),a("#tip_ases_status").html("Se realiza seguimiento en esta instancia")):""==b.previous_status&&(a("#icon-tracking").removeClass("i-tracking-n"),a("#icon-tracking").addClass("i-tracking-t"),a("#tip_ases_status").html("No se realiza seguimiento")),modal_dropout.hide(),swal(b.title,b.msg,b.status)},dataType:"json",cache:"false",error:function(a){modal_dropout.hide(),swal(a.title,a.msg,a.status)}})})):"seguimiento"==c&&a.ajax({type:"POST",data:e,url:"../managers/student_profile/studentprofile_serverproc.php",success:function(b){d=c,a("#input_status_ases").val(c),"seguimiento"==b.previous_status?(a("#icon-tracking").removeClass("i-tracking-t"),a("#icon-tracking").addClass("i-tracking-n"),a("#tip_ases_status").html("Se realiza seguimiento en otra instancia")):"sinseguimiento"==b.previous_status?(a("#icon-tracking").removeClass("i-tracking-f"),a("#icon-tracking").addClass("i-tracking-t"),a("#tip_ases_status").html("Se realiza seguimiento en esta instancia")):""==b.previous_status&&(a("#icon-tracking").removeClass("i-tracking-n"),a("#icon-tracking").addClass("i-tracking-t"),a("#tip_ases_status").html("Se realiza seguimiento en esta instancia"))},dataType:"json",cache:"false",error:function(a){console.log(a)}}).then(function(a){swal(a.title,a.msg,a.status)}))})}},update_tracking_status:function(b,c,d,e){has_tracking_status=!1,0==b?(has_tracking_status=e.validate_tracking_statuses(d),has_tracking_status.tracking_status&&swal({title:"¿Está seguro/a de cambiar el estado?",text:"Texto a cambiar",type:"warning",showCancelButton:!0,confirmButtonColor:"#d51b23",confirmButtonText:"Si",cancelButtonText:"No",closeOnConfirm:!0,allowEscapeKey:!1},function(d){d?(c.prop("checked",!0),a("#div_flags_"+has_tracking_status.academic_program_id).prop("checked",!1)):b?c.prop("checked",!0):c.prop("checked",!1)})):c.prop("checked",!0)},validate_tracking_statuses:function(a){for(has_tracking_status=!1,i=0;i<a.length;i++)if(1==a[i].tracking_status){has_tracking_status=!0;break}return a[i]},get_url_parameters:function(a){for(var b=[],c=document.location.search.substring(1),d=c.split("&"),e=0;e<d.length;e++){var f=d[e].split("=");b[f[0]]=f[1]}return b}}});