'use strict';define(['jquery','block_ases/bootstrap','block_ases/sweetalert','block_ases/validator'],function(a){return{init:function init(){function e(j){var k=j.children[2].children[0].children[0],l=k.children[0],m=j.children[4].children[1];response_div=document.getElementById('response_div'),response_span=document.getElementById('response_span'),response_span.innerHTML='',response_div.setAttribute('hidden','hidden'),k.classList.remove('green_bar','red_bar');var n=new XMLHttpRequest;n.upload.addEventListener('progress',function(o){var p=Math.round(100*(o.loaded/o.total));k.style.width=p+'%',l.innerHTML=p+'%'}),n.addEventListener('load',function(){'1'==n.response?(k.classList.add('green_bar'),l.innerHTML='\xC9xito',response_div.removeAttribute('hidden'),response_span.classList.add('response_success'),response_span.innerHTML+='El contenido del archivo ha sido cargado con \xE9xito en la base de datos.'):(k.classList.add('red_bar'),l.innerHTML='Error',response_div.removeAttribute('hidden'),response_span.classList.add('response_error'),response_span.innerHTML=n.response)}),n.open('post','../managers/upload_files_form/subir_archivo.php'),n.send(new FormData(j)),m.addEventListener('click',function(){n.abort(),k.classList.remove('green_bar'),k.classList.add('red_bar'),l.innerHTML='Proceso cancelado'})}function f(j){a.ajax({url:'../managers/upload_files_form/eliminar_archivo.php',type:'POST',timeout:1e4,data:{archivo:j},error:function error(){h('Error al intentar eliminar el archivo.',!1)},success:function success(k){1==k?h('El archivo ha sido eliminado.',!0):h('Error al intentar eliminar el archivo.',!1),g()}})}function g(){a.ajax({url:'../managers/upload_files_form/mostrar_archivos.php',dataType:'JSON',success:function success(j){if(j){for(var k='',l=0;l<j.length;l++)void 0!=j[l]&&(k+='<div class="row"> <span class="col-md-3"> '+j[l]+' </span> <div class="col-md-2"> <a class="eliminar_archivo btn btn-danger " id="btn_eliminar" name="elim" href="javascript:void(0);"> Eliminar </a> </div> </div> <hr />');a('#archivos_subidos').html(k)}}})}function h(j,k){if(a('#respuesta').removeClass('alert-success').removeClass('alert-danger').html(j),k)a('#respuesta').addClass('alert-success'),setTimeout('document.location.reload()',500);else{a('#respuesta').addClass('alert-danger');var l=a('<br> <div class="row"><div class="col-md-2 col-md-offset-5"><a class="continue btn btn-danger" href="javascript:void(0);"> Continuar </a></div></div>');l.appendTo(a('#respuesta'))}}a(document).ready(function(){g();var j=document.getElementById('upload_data_form');a('#load_button').on('click',function(){e(j)}),a('#archivos_subidos').on('click','.eliminar_archivo',function(){var k=a(this).parents('.row').eq(0).find('span').text();k=a.trim(k),f(k)}),a('#respuesta').on('click','.continue',function(){setTimeout('document.location.reload()',500)})})}}});