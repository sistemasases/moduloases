define(["jquery","block_ases/jszip","block_ases/pdfmake","block_ases/jquery.dataTables","block_ases/dataTables.autoFill","block_ases/dataTables.buttons","block_ases/buttons.html5","block_ases/buttons.flash","block_ases/buttons.print","block_ases/bootstrap","block_ases/sweetalert2","block_ases/jqueryui","block_ases/select2","block_ases/Chart","block_ases/loading_indicator","block_ases/chartjs_plugin_datalabels"],function(a,e,t,o,r,n,s,c,d,l,g,b,h,u,p,f){return{init:function(){window.JSZip=e,window.graficas={};const t=["programa","facultad","sexo","edad","condExcepcion","riesgos"];for(i=0;i<t.length;i++)a("#list-students-"+t[i]+"-panel").on("click",function(a){_(String(a.currentTarget.id).split("-")[2])}),a("#save_btn_"+t[i]).on("click",function(a){var e=String(a.target.id).split("_")[2];document.getElementById("download_"+e).click()});a("#status_fields").on("change",function(){for(i=0;i<t.length;i++)a("#"+t[i]).length>0&&_(t[i])}),a("#conditions").on("change",function(){for(i=0;i<t.length;i++)a("#"+t[i]).length>0&&_(t[i])})}};function _(e){var t=a("#ases_status").is(":checked")?1:0,o=a("#icetex_status").is(":checked")?1:0,r=a("#academic_program_status").is(":checked")?1:0;a.ajax({type:"POST",data:{type:e,cohort:a("#conditions").val(),ases_status:t,icetex_status:o,program_status:r,instance_id:C()},url:"../managers/ases_report/asesreport_graphics_processing.php",success:function(t){switch(function(e,t){a("#div_table_"+e).empty(),a("#div_table_"+e).append('<table id="t_'+e+'" class="table" cellspacing="0" width="100%"><thead> </thead></table>'),a("#t_"+e).DataTable(t)}(e,t),e){case"programa":w(e,t.data,"horizontalBar");break;case"edad":w(e,t.data,"bar");break;case"facultad":m(e,t.data,"doughnut");break;case"sexo":m(e,t.data,"pie");break;case"condExcepcion":m(e,t.data,"doughnut");break;case"riesgos":!function(e){var t=[],o=[],r=[],i=[],n=[];for(riesgo in e)t.push(e[riesgo].riesgo),o.push(e[riesgo].bajo),r.push(e[riesgo].medio),i.push(e[riesgo].alto),n.push(e[riesgo].no_registra);a(".risk-chart-container").css("width","100%");var s=document.getElementById("grafica_riesgos").getContext("2d"),e={labels:t,datasets:[{label:"Riesgos bajos",data:o,backgroundColor:"rgba(0, 179, 136, 0.4)",borderColor:"rgba(0, 179, 136, 1)",borderWidth:2},{label:"Riesgos Medios",data:r,backgroundColor:"rgba(255, 136, 17, 0.4)",borderColor:"rgba(255, 136, 17, 1)",borderWidth:2},{label:"Riesgos Altos",data:i,backgroundColor:"rgba(255, 86, 102, 0.4)",borderColor:"rgba(255, 86, 102, 1)",borderWidth:2},{label:"N.R.",data:n,backgroundColor:"rgba(132, 133, 134, 0.4)",borderColor:"rgba(132, 133, 134, 1)",borderWidth:2}]};if(window.graficas.chart_riesgos)window.graficas.chart_riesgos.data=e,window.graficas.chart_riesgos.update();else{u.plugins.register({beforeDraw:function(a){var e=a.chart.ctx;e.fillStyle="white",e.fillRect(0,0,a.chart.width,a.chart.height)}});var c={title:{display:!0,text:"Cantidad de registros por riesgos",fontSize:25},legend:{display:!0,labels:{fontSize:15,fontStyle:"bold"}},starAngle:0,scales:{xAxes:[{ticks:{fontSize:15,fontStyle:"bold"}}]},showTooltips:!0,showPercentages:!0,animation:{animateRotate:!0,animateScale:!0,duration:0,onProgress:function(a){},onComplete:function(e){var t=document.getElementById("grafica_riesgos").toDataURL("image/jpeg");a("#download_riesgos").attr("href",t),a("#download_riesgos").attr("download","reporte_riesgos.jpg")}}};u.defaults.polarArea.animation.animateScale=!1,window.graficas.chart_riesgos=new u(s,{type:"bar",data:e,options:c})}}(t.data)}},dataType:"json",cache:!1,async:!0,failure:function(a){}})}function w(e,t,o){var r=Object.keys(t[0]),i=r[0],n=r[1],s=[],c=[];for(var d in t)nombre=t[d][i],cantidad=t[d][n],nombre=nombre.replace("LICENCIATURA","LIC."),nombre=nombre.replace(/EDUCACIÓN/g,"EDU."),s.push(nombre),c.push(cantidad);a(".horizontal-bar-chart-container").css("height","1300px"),a(".horizontal-bar-chart-container").css("width","100%"),a(".bar-chart-container").css("height","800px"),a(".bar-chart-container").css("width","100%");for(var l=[],g=[],b=0;b<s.length;b++)b%2==0?(l.push("rgba(255, 99, 132, 0.2)"),g.push("rgba(255, 99, 132, 1)")):(l.push("rgba(130, 130, 130, 0.2)"),g.push("rgba(130, 130, 130, 1)"));var h=document.getElementById("grafica_"+e).getContext("2d");t={labels:s,datasets:[{label:"Cantidad de Estudiantes",data:c,backgroundColor:l,borderColor:g,borderWidth:3}]};if(window.graficas["chart_"+e])window.graficas["chart_"+e].data=t,window.graficas["chart_"+e].update();else{var p=e;"condExcepcion"===e&&(p="Condición de Excepción"),u.plugins.register({beforeDraw:function(a){var e=a.chart.ctx;e.fillStyle="white",e.fillRect(0,0,a.chart.width,a.chart.height)}}),window.graficas["chart_"+e]=new u(h,{type:o,data:t,options:{elements:{rectangle:{borderWidth:2}},backgroundColor:"white",responsive:!0,legend:{position:"top",display:!1},title:{display:!0,text:"Cantidad de Estudiantes por "+p,fontSize:30},scales:{yAxes:[{ticks:{display:!0},categoryPercentage:1,barPercentage:1}],xAxes:[{ticks:{beginAtZero:!0}}]},maintainAspectRatio:!1,plugins:{datalabels:{display:!0,align:"center",anchor:"center"}},animation:{duration:0,onProgress:function(a){},onComplete:function(t){var o=document.getElementById("grafica_"+e).toDataURL("image/jpeg");a("#download_"+e).attr("href",o),a("#download_"+e).attr("download","reporte_"+e+".jpg")}}}})}}function m(e,t,o){var r=[],i=[];for(var n in t)nombre=t[n].nombre,cantidad=t[n].cantidad,r.push(nombre),i.push(cantidad);var s=document.getElementById("grafica_"+e).getContext("2d");t={labels:r,datasets:[{label:"Cantidad de Estudiantes",data:i,backgroundColor:["#F56476","#BFD1E5","#FFEECF","#C9A690","#DF928E","#CECCCC","#9191E9","#99E1D9","#FFA552","#BFC8AD","#0BAA6B","#EDD892"],borderColor:["#F56476","#BFD1E5","#FFEECF","#C9A690","#DF928E","#CECCCC","#9191E9","#99E1D9","#FFA552","#BFC8AD","#0BAA6B","#EDD892"],borderWidth:1}]};if(window.graficas["chart_"+e])window.graficas["chart_"+e].data=t,window.graficas["chart_"+e].update();else{var c=e;"condExcepcion"===e&&(c="Condición de Excepción"),u.plugins.register({beforeDraw:function(a){var e=a.chart.ctx;e.fillStyle="white",e.fillRect(0,0,a.chart.width,a.chart.height)}});var d={title:{display:!0,text:"Cantidad de estudiantes por "+c,fontSize:30},legend:{display:!0},starAngle:0,showTooltips:!0,showPercentages:!0,animation:{animateRotate:!0,animateScale:!0,duration:0,onProgress:function(a){},onComplete:function(t){var o=document.getElementById("grafica_"+e).toDataURL("image/jpeg");a("#download_"+e).attr("href",o),a("#download_"+e).attr("download","reporte_"+e+".jpg")}}};u.defaults.polarArea.animation.animateScale=!1,window.graficas["chart_"+e]=new u(s,{type:o,data:t,options:d})}}function C(){var a=location.search.split("&");for(x in a){if(a[x].indexOf("instanceid")>=0)return a[x].split("=")[1]}return 0}});
