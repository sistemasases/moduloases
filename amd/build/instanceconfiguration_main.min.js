'use strict';define(['jquery','block_ases/sweetalert','block_ases/datatables'],function(a){return{init:function init(){function d(){var i=a('#username_input').val(),j=[];j.push({name:'function',value:'search'}),j.push({name:'username',value:i}),a.ajax({type:'POST',data:j,url:'../managers/instance_management/instance_configuration_serverproc.php',success:function success(k){var l=k.error;l?swal({title:'Error',html:!0,type:'error',text:k.error,confirmButtonColor:'#D3D3D3'}):(a('#username_input').prop('disabled',!0),a('#lista_programas').prop('disabled',!1),a('#name_lastname').val(k.firstname+' '+k.lastname),a('#lista_programas').append('<option value="'+k.cod_programa+'" selected> '+k.cod_programa+' - '+k.nombre_programa+'</option>'),1==k.seg_academico?a('label input[name="segAca"][ value="1"]').prop('checked',!0):a('label input[name="segAca" ][ value="0"]').prop('checked',!0),1==k.seg_asistencias?a('label input[name="segAsis" ][ value="1"]').prop('checked',!0):a('label input[name="segAsis"][ value="0"]').prop('checked',!0),1==k.seg_socioeducativo?a('label input[name="segSoc" ][ value="1"]').prop('checked',!0):a('label input[name="segSoc"][ value="0"]').prop('checked',!0))},dataType:'json',cache:'false',error:function error(k){console.log(k)}})}function e(){a('#lista_programas').html(''),a.ajax({type:'POST',data:[{name:'function',value:'load_programs'}],url:'../managers/instance_management/instance_configuration_serverproc.php',success:function success(i){if(a('#lista_programas').append('<option value="0" selected> 0000 - Ninguno</option>'),i)for(x in i)a('#lista_programas').append('<option value="'+i[x].cod_univalle+'">'+i[x].cod_univalle+' - '+i[x].nombre+'</option>')},dataType:'json',cache:'false',error:function error(i){console.log(i)}})}function f(){a('#username_input').prop('disabled',!1),a('#name_lastname').prop('disabled',!1);var i=a('#username_input').val(),j=a('#lista_programas option[value=\''+a('#lista_programas').val()+'\']').text(),k=a('#lista_programas').val(),l=a('input, select').serializeArray();a('#username_input').prop('disabled',!0),a('#name_lastname').prop('disabled',!0);var n=0,o=location.search.split('&');for(x in o)if(0<=o[x].indexOf('instanceid')){var p=o[x].split('=');n=p[1]}l.push({name:'idinstancia',value:n}),l.push({name:'function',value:'updateUser'}),a.ajax({type:'POST',data:l,url:'../managers/instance_management/instance_configuration_serverproc.php',success:function success(q){!0===q?(swal({title:'Actualizado con exito!!',html:!0,type:'success',text:'El usuario con c\xF3digo '+i+' es ahora administrador del sistema de '+j,confirmButtonColor:'#d51b23'},function(r){}),a('#next_div').fadeIn(),g(),e()):swal({title:'Error :(',html:!0,type:'error',text:q,confirmButtonColor:'#d51b23'},function(r){})},dataType:'json',cache:'false',error:function error(q){console.log(q)}})}function g(){var i=[];i.push({name:'function',value:'loadSystemAdministrators'}),a.ajax({type:'POST',data:i,url:'../managers/instance_management/instance_configuration_serverproc.php',success:function success(j){a('#div_users').empty(),a('#div_users').append('<table id="tableUsers" class="display" cellspacing="0" width="100%"><thead><thead></table>');a('#tableUsers').DataTable(j);a('#div_users #delete_user').css('cursor','pointer')},dataType:'json',cache:'false',error:function error(j){console.log(j)}})}function h(i){var j=[];j.push({name:'function',value:'deleteUser'}),j.push({name:'username',value:i}),a.ajax({type:'POST',data:j,url:'../managers/instance_management/instance_configuration_serverproc.php',success:function success(k){!0===k?(swal({title:'Actualizado con exito!!',html:!0,type:'success',text:'El usuario con c\xF3digo '+i+' se ha eliminado satisfactoriamente',confirmButtonColor:'#d51b23'},function(l){}),g(),e()):swal({title:'Error :(',html:!0,type:'error',text:k,confirmButtonColor:'#d51b23'},function(l){})},dataType:'json',cache:'false',error:function error(k){console.log(k)}})}a(document).ready(function(){a('#search_button').on('click',function(){a('.assignment_li').removeClass('hidden');var i=a('#username_input').val();return null===i||''==i?0:void d()}),a('#ok_button').on('click',function(){f()}),a('#cancel_button').on('click',function(){a('.assignment_li').addClass('hidden'),a('#form_mon_student').fadeOut(),a('#username_input').val(''),a('#username_input').prop('disabled',!1),a('#name_lastname').val(' '),a('#form_prof_type').fadeOut()}),a('#next').on('click',function(){location.href='upload_files_form.php'+location.search}),a('#listadministradores').on('click',function(){g()}),g(),a('#div_users').on('click','#delete_user',function(){var i=a('#div_users #tableUsers').DataTable(),j=a(this).parent(),k=a(this).children('span').attr('id'),l=i.cell(j).index().column,m=i.cell(i.row(j).index(),0).data(),n=i.cell(i.row(j).index(),1).data(),o=i.cell(i.row(j).index(),2).data();swal({title:'\xBFEstas seguro/a?',text:'Al usuario <strong>'+n+' '+o+'</strong> con c\xF3digo <strong>'+m+'</strong> se le inhabilitar\xE1 los permisos de administrador del sistema</strong>.<br><strong>\xBFEst\xE1s de acuerdo con los cambios que se efectuar\xE1n?</strong>',type:'warning',html:!0,showCancelButton:!0,confirmButtonColor:'#d51b23',confirmButtonText:'Si!',cancelButtonText:'No',closeOnConfirm:!0},function(p){p&&h(m)})})})}}});