'use strict';define(['jquery','block_ases/jszip','block_ases/jquery.dataTables','block_ases/dataTables.autoFill','block_ases/dataTables.buttons','block_ases/buttons.html5','block_ases/buttons.flash','block_ases/buttons.print','block_ases/bootstrap','block_ases/sweetalert','block_ases/jqueryui','block_ases/select2'],function(a){return{init:function init(){function n(H,I){var J=a('#input_json_academics_saved').val();a.ajax({type:'POST',data:{func:'edit_academics_data',json:H,json_prev:J,instanceid:E(),courseid:F(),ases:I},url:'../managers/student_profile/others_tab_api.php',success:function success(K){swal({title:K.title,text:K.msg,type:K.status},function(){a('html, body').animate({scrollTop:820},'slow'),a('#input_academics_saved').attr('value','1'),a('#input_json_academics_saved').attr('value',H)})},dataType:'json',cache:'false',error:function error(K){swal(K.title,K.msg,K.status)}})}function o(H,I){var J=a('#input_json_academics_saved').val();a.ajax({type:'POST',data:{func:'save_academics_data',json:H,json_prev:J,instanceid:E(),courseid:F(),ases:I},url:'../managers/student_profile/others_tab_api.php',success:function success(K){swal({title:K.title,text:K.msg,type:K.status},function(){a('html, body').animate({scrollTop:700},'slow'),a('#save_academics_data').parent().hide(),a('#edit_academics_data').parent().show(),a('#input_academics_saved').attr('value','1'),a('#input_json_academics_saved').attr('value',H)})},dataType:'json',cache:'false',error:function error(K){swal(K.title,K.msg,K.status)}})}function p(){var H={},I=[],J={},K=0;return a('.table_aspectos_instituciones tr').find(':input').each(function(){K++,'name_institucion'==a(this).attr('name')&&(J.name_institution=a(this).val()),'nivel_academico_institucion'==a(this).attr('name')&&(J.academic_level=a(this).val()),'apoyos_institucion'==a(this).attr('name')&&(J.supports=a(this).val()),4==K&&(I.push(J),J={},K=0)}),H.current_resolution=a('#current_resolution').val(),H.total_time=a('#total_time').val(),H.previous_academic_title=a('#titulo_academico').val(),H.others_institutions=I,H.academics_observations=a('#textarea_academics_observaciones').val(),H.academics_dificults=a('#textarea_academics_dificultades').val(),H}function q(){var H={};return H.title='\xC9xito',H.msg='El formulario fue validado con \xE9xito',H.status='success',a('#collapse_add_academics input[type=number]').each(function(){var I=a(this).val(),J=a(this).attr('placeholder'),K=a(this).attr('id');if('total_time'==K&&(0>I||999<I))return H.title='Datos acad\xE9micos (cr\xE9ditos totales)',H.status='error',H.msg='El campo '+J+' es obligatorio',H}),H}function s(H,I){var J=a('#input_json_economics_saved').val();a.ajax({type:'POST',data:{func:'edit_economics_data',json:H,json_prev:J,instanceid:E(),courseid:F(),ases:I},url:'../managers/student_profile/others_tab_api.php',success:function success(K){swal({title:K.title,text:K.msg,type:K.status},function(){a('html, body').animate({scrollTop:700},'slow'),a('#input_economics_saved').attr('value','1'),a('#input_json_economics_saved').attr('value',H)})},dataType:'json',cache:'false',error:function error(K){swal(K.title,K.msg,K.status)}})}function t(H,I){var J=a('#input_json_economics_saved').val();a.ajax({type:'POST',data:{func:'save_economics_data',json:H,json_prev:J,instanceid:E(),courseid:F(),ases:I},url:'../managers/student_profile/others_tab_api.php',success:function success(K){swal({title:K.title,text:K.msg,type:K.status},function(){a('html, body').animate({scrollTop:700},'slow'),a('#save_economics_data').parent().hide(),a('#edit_economics_data').parent().show(),a('#input_economics_saved').attr('value','1'),a('#input_json_economics_saved').attr('value',H)})},dataType:'json',cache:'false',error:function error(K){swal(K.title,K.msg,K.status)}})}function u(){var H=[],I={key_input:'#estrato_socioeconomico',val_input:a('#estrato_socioeconomico').val()};H.push(I);var J={};a('#collapse_econo input[type=checkbox]').not('.check_solvencia').each(function(){J.key_input=a(this).attr('id'),a(this).is(':checked')?(J.val_input=1,a(this).parent().next().children().children('input').each(function(){var Q=a(this).attr('type');'text'==Q&&(J.key_input_text=a(this).attr('id'),J.val_input_text=a(this).val()),'number'==Q&&(J.key_input_number=a(this).attr('id'),J.val_input_number=a(this).val())})):J.val_input=0,H.push(J),J={}});var K={key_input:'#check_solvencia'};K.val_input=a('#check_solvencia').is(':checked')?1:0,H.push(K);var L={},M=[],N=[],O=[];for(obj=document.getElementById('div_info_padre'),i=0;ele=obj.getElementsByTagName('select')[i];i++)L.key_select=ele.id,L.val_select=ele.value,'select_nivel_padre'==ele.id&&M.push(L),'select_ocupacion_padre'==ele.id&&('option_ninguna'!=ele.value&&(L.key_input_select='#'+a('#'+ele.id).parent().next().children('input').attr('id'),L.val_input_select=a('#'+ele.id).parent().next().children('input').val(),L.title_select=ele.title),N.push(L)),'select_situa_padre'==ele.id&&O.push(L),L={};for(obj=document.getElementById('div_info_madre'),i=0;ele=obj.getElementsByTagName('select')[i];i++)L.key_select=ele.id,L.val_select=ele.value,'select_nivel_madre'==ele.id&&M.push(L),'select_ocupacion_madre'==ele.id&&('option_ninguna'!=ele.value&&(L.key_input_select='#'+a('#'+ele.id).parent().next().children('input').attr('id'),L.val_input_select=a('#'+ele.id).parent().next().children('input').val(),L.title_select=ele.title),N.push(L)),'select_situa_madre'==ele.id&&O.push(L),L={};H.push(N),H.push(M),H.push(O);var P={key_input:'#textarea_expectativas',val_input:a('#textarea_expectativas').val()};return H.push(P),H}function v(){var H={};if(H.title='\xC9xito',H.msg='El formulario fue validado con \xE9xito',H.status='success',a('#collapse_econo input[type=checkbox]').not('.check_solvencia').each(function(){a(this).is(':checked')&&a(this).parent().next().children().children('input').each(function(){var P=a(this).val(),Q=a(this).attr('id'),R=a(this).attr('type');if(''==P)return H.title='Datos econ\xF3micos',H.status='error',H.msg='El campo '+Q+' es obligatorio',H;if('number'==R){if(Number.isNaN(P))return H.title='Datos econ\xF3micos',H.status='error',H.msg='El campo '+Q+' debe ser num\xE9rico',H;if(0>P)return H.title='Datos econ\xF3micos',H.status='error',H.msg='El campo '+Q+' no debe ser negativo',H}})}),''==a('#estrato_socioeconomico').val()){return H.title='Datos econ\xF3micos',H.status='error',H.msg='El campo '+'estrato_socioeconomico'+' es obligatorio y debe ser n\xFAmero entero',H}var J=a('#estrato_socioeconomico').val();if(1>J||6<J||0!=J%1)return H.title='Datos econ\xF3micos',H.status='error',H.msg='El campo '+'estrato_socioeconomico'+' corresponde a estratos sociales (Del 1 al 6)',H;if('option_ninguna'!=a('#select_ocupacion_madre').val()){var L=a('#input_ocupacion_madre').val();if(''==L)return H.title='Datos econ\xF3micos',H.status='error',H.msg='El campo '+'input_ocupacion_madre'+' es obligatorio',H}if('option_ninguna'!=a('#select_ocupacion_padre').val()){var N=a('#input_ocupacion_padre').val();if(''==N)return H.title='Datos econ\xF3micos',H.status='error',H.msg='El campo '+'input_ocupacion_padre'+' es obligatorio',H}return H}function y(H,I){var J=a('#input_json_health_saved').val();a.ajax({type:'POST',data:{func:'edit_health_data',json:H,json_prev:J,instanceid:E(),courseid:F(),ases:I},url:'../managers/student_profile/others_tab_api.php',success:function success(K){swal({title:K.title,text:K.msg,type:K.status},function(){a('html, body').animate({scrollTop:820},'slow'),a('#input_health_saved').attr('value','1'),a('#input_json_health_saved').attr('value',H)})},dataType:'json',cache:'false',error:function error(K){swal(K.title,K.msg,K.status)}})}function z(H,I){var J=a('#input_json_health_saved').val();a.ajax({type:'POST',data:{func:'save_health_data',json:H,json_prev:J,instanceid:E(),courseid:F(),ases:I},url:'../managers/student_profile/others_tab_api.php',success:function success(K){swal({title:K.title,text:K.msg,type:K.status},function(){a('html, body').animate({scrollTop:820},'slow'),a('#save_health_data').parent().hide(),a('#edit_health_data').parent().show(),a('#input_health_saved').attr('value','1'),a('#input_json_health_saved').attr('value',H)})},dataType:'json',cache:'false',error:function error(K){swal(K.title,K.msg,K.status)}})}function A(){var H=[],I=a('#opciones_regimen_salud').find(':input[type=radio]:checked').val(),J=a('#opciones_regimen_salud').find(':input[type=radio]:checked').attr('id'),L=a('#opciones_servicio_salud').find(':input[type=radio]:checked').val(),M=a('#opciones_servicio_salud').find(':input[type=radio]:checked').attr('id'),N=a('#input_detalle_servicio').val(),Q=[],R={};return a('#options_services input[type=checkbox]').each(function(){R.key_input=a(this).attr('id'),a(this).is(':checked')?(R.val_input=1,'check_servicio_otro'==R.key_input&&(R.key_input_text='servicio_otro_cual',R.val_input_text=a('#servicio_otro_cual').val())):R.val_input=0,Q.push(R),R={}}),H.push({key_input:J,val_input:I}),H.push({key_input:M,val_input:L,val_input_text:N,key_input_text:'input_detalle_servicio'}),H.push(Q),H}function B(){var H={};if(H.title='\xC9xito',H.msg='El formulario fue validado con \xE9xito',H.status='success',a('#check_servicio_otro').is(':checked')){var I=a('#servicio_otro_cual').val(),J='Otro servicio';if(''==I)return H.title='Datos de servicios de salud',H.status='error',H.msg='El campo '+J+' es obligatorio',H;if(D(I))return H.title='Datos de servicios de salud',H.status='error',H.msg='El campo '+J+' no debe contener n\xFAmeros',H}var K=a('#opciones_regimen_salud').find(':input[type=radio]:checked').val();if(void 0==K){return H.title='Datos de servicios de salud',H.status='error',H.msg='El campo '+'R\xE9gimen de salud'+' es obligatorio',H}var M=a('#opciones_servicio_salud').find(':input[type=radio]:checked').val();if(void 0!=M){var O,N=a('#input_detalle_servicio').val();switch(M){case'input_radio_eps':if(O='\xBFCu\xE1l EPS?',''==N)return H.title='Datos de servicios de salud',H.status='error',H.msg='El campo '+O+' es obligatorio',H;if(D(N))return H.title='Datos de servicios de salud',H.status='error',H.msg='El campo '+O+' no debe contener n\xFAmeros',H;break;case'input_radio_sisben':if(O='\xBFCu\xE1l Nivel?',''==N)return H.title='Datos de servicios de salud',H.status='error',H.msg='El campo '+O+' es obligatorio y num\xE9rico',H;if(1>N||3<N)return H.title='Datos de servicios de salud',H.status='error',H.msg='El campo '+O+' corresponde a niveles v\xE1lidos de SISBEN (1,2,3)',H;break;case'input_radio_otro_servicio':if(O='\xBFCu\xE1l servicio de salud?',''==N)return H.title='Datos de servicios de salud',H.status='error',H.msg='El campo '+O+' es obligatorio',H;if(D(N))return H.title='Datos de servicios de salud',H.status='error',H.msg='El campo '+O+' no debe contener n\xFAmeros',H;}}else{return H.title='Datos de servicios de salud',H.status='error',H.msg='El campo '+'Servicio de salud'+' es obligatorio',H}return H}function C(H,I,J,K,L,M){1==I?(a('#'+H).prop('checked',!0),a('#'+J).val(K),a('#'+J).parent().parent().show(),a('#'+L).val(M)):(a('#'+H).prop('checked',!1),a('#'+J).val(''),a('#'+J).parent().parent().hide(),a('#'+L).val(''))}function D(H){for(i=0;i<H.length;i++)if(-1!='0123456789'.indexOf(H.charAt(i),0))return 1;return 0}function E(){var H=location.search.split('&');for(x in H)if(0<=H[x].indexOf('instanceid')){var I=H[x].split('=');return I[1]}return 0}function F(){var H=location.search.split('&');for(x in H)if(0<=H[x].indexOf('courseid')){var I=H[x].split('=');return I[1]}return 0}var G=a('#id_ases').val();a('#edit_health_data').click(function(){var H=B();if('error'==H.status)swal(H.title,H.msg,H.status);else{var I=A();I=JSON.stringify(I),y(I,G)}}),a('#save_health_data').click(function(){var H=B();if('error'==H.status)swal(H.title,H.msg,H.status);else{var I=A();I=JSON.stringify(I),z(I,G)}}),'0'==a('#input_health_saved').val()&&a('#save_health_data').parent().show(),'1'==a('#input_health_saved').val()&&(a('#save_health_data').parent().hide(),a('#edit_health_data').parent().show(),function(){var H,J,K,L,M=JSON.parse(a('#input_json_health_saved').val());for(i in M)switch(i){case'regimen_salud':L=JSON.parse(M[i]),a('#'+L.key_input).prop('checked',!0);;break;case'servicio_salud_vinculado':L=JSON.parse(M[i]),H=L.key_input,J=L.key_input_text,K=L.val_input_text,a('#'+H).prop('checked',!0),a('#'+J).val(K),a('#'+J).parent().show(),'input_radio_sisben'==H&&(a('#'+J).attr('title','Escriba Nivel'),a('#'+J).attr('type','number'),a('#'+J).attr('min','1'),a('#'+J).attr('max','3')),'input_radio_eps'==H?(a('#'+J).attr('title','Escriba EPS'),a('#'+J).attr('placeholder','\xBFCu\xE1l EPS?'),a('#'+J).attr('type','text')):'input_radio_otro_servicio'==H&&(a('#'+J).attr('title','Escriba otro servicio'),a('#'+J).attr('placeholder','\xBFCu\xE1l servicio de salud?'),a('#'+J).attr('type','text'));break;case'servicios_usados':for(objeto in L=JSON.parse(M[i]),L)1==L[objeto].val_input?(a('#'+L[objeto].key_input).prop('checked',!0),'check_servicio_otro'==L[objeto].key_input&&(a('#'+L[objeto].key_input_text).val(L[objeto].val_input_text),a('#'+L[objeto].key_input_text).parent().show())):(a('#'+L[objeto].key_input).prop('checked',!1),'check_servicio_otro'==L[objeto].key_input&&(a('#servicio_otro_cual').val(''),a('#servicio_otro_cual').parent().hide()));}}()),a('#check_servicio_otro').click(function(){a(this).is(':checked')?(a('#servicio_otro_cual').parent().show(),a('#servicio_otro_cual').prop('required',!0)):(a('#servicio_otro_cual').parent().hide(),a('#servicio_otro_cual').prop('required',!1),a('#servicio_otro_cual').val(''))}),a('.servicio_salud').click(function(){'input_radio_eps'==a(this).val()?(a('#input_detalle_servicio').attr('title','Escriba EPS'),a('#input_detalle_servicio').attr('placeholder','\xBFCu\xE1l EPS?'),a('#input_detalle_servicio').attr('type','text')):'input_radio_sisben'==a(this).val()?(a('#input_detalle_servicio').attr('title','Escriba Nivel'),a('#input_detalle_servicio').attr('placeholder','\xBFCu\xE1l Nivel?'),a('#input_detalle_servicio').attr('type','number'),a('#input_detalle_servicio').attr('min','1'),a('#input_detalle_servicio').attr('max','3')):'input_radio_otro_servicio'==a(this).val()&&(a('#input_detalle_servicio').attr('title','Escriba otro servicio'),a('#input_detalle_servicio').attr('placeholder','\xBFCu\xE1l servicio de salud?'),a('#input_detalle_servicio').attr('type','text')),a('#input_detalle_servicio').parent().show(),a('#input_detalle_servicio').attr('required',!0),a('#input_detalle_servicio').val('')}),'0'==a('#input_economics_saved').val()&&a('#save_economics_data').parent().show(),'1'==a('#input_economics_saved').val()&&(a('#save_economics_data').parent().hide(),a('#edit_economics_data').parent().show(),function(){var H,I,J,K,L,M,N,O=JSON.parse(a('#input_json_economics_saved').val());for(i in O)switch(i){case'estrato':a('#estrato_socioeconomico').val(O[i]);break;case'prestacion_economica':N=JSON.parse(O[i]),H=N.key_input,I=N.val_input,J=N.key_input_text,K=N.val_input_text,L=N.key_input_number,M=N.val_input_number,C(H,I,J,K,L,M);break;case'beca':N=JSON.parse(O[i]),H=N.key_input,I=N.val_input,J=N.key_input_text,K=N.val_input_text,L=N.key_input_number,M=N.val_input_number,C(H,I,J,K,L,M);break;case'ayuda_transporte':N=JSON.parse(O[i]),H=N.key_input,I=N.val_input,J=N.key_input_text,K=N.val_input_text,L=N.key_input_number,M=N.val_input_number,C(H,I,J,K,L,M);break;case'ayuda_materiales':N=JSON.parse(O[i]),H=N.key_input,I=N.val_input,J=N.key_input_text,K=N.val_input_text,L=N.key_input_number,M=N.val_input_number,C(H,I,J,K,L,M);break;case'solvencia_econo':I=O[i],1==I?a('#check_solvencia').prop('checked',!0):a('#check_solvencia').prop('checked',!1);break;case'ocupacion_padres':for(objeto in N=JSON.parse(O[i]),N)'option_ninguna'==N[objeto].val_select?a('#'+N[objeto].key_select).val(N[objeto].val_select):(a('#'+N[objeto].key_select).val(N[objeto].val_select),a('#'+N[objeto].key_select).attr('title',N[objeto].title_select),a(N[objeto].key_input_select).val(N[objeto].val_input_select),a(N[objeto].key_input_select).parent().show());break;case'nivel_educ_padres':for(objeto in N=JSON.parse(O[i]),N)a('#'+N[objeto].key_select).val(N[objeto].val_select);break;case'situa_laboral_padres':for(objeto in N=JSON.parse(O[i]),N)a('#'+N[objeto].key_select).val(N[objeto].val_select);break;case'expectativas_laborales':N=JSON.parse(O[i]),a(N.key_input).val(N.val_input);}}()),a('#collapse_econo input[type=checkbox]').not('.check_solvencia').on('change',function(){a(this).is(':checked')?(a(this).parent().next().show(),a(this).parent().next().children().children('input').prop('required',!0)):(a(this).parent().next().hide(),a(this).parent().next().children().children('input').prop('required',!1),a(this).parent().next().children().children('input').val(''))}),a('.select_ocupacion').on('change',function(){if('option_ninguna'==a(this).val())a(this).parent().next().hide(),a(this).parent().next().children('input').prop('required',!1),a(this).parent().next().children('input').val('');else{a(this).parent().next().show(),a(this).parent().next().children('input').prop('required',!0);var H=document.getElementById(a(this).attr('id'));a(this).attr('title',H.options[H.selectedIndex].title)}}),a('#save_economics_data').click(function(){var H=v();if('error'==H.status)swal(H.title,H.msg,H.status);else{var I=u();I=JSON.stringify(I),t(I,G)}}),a('#edit_economics_data').click(function(){var H=v();if('error'==H.status)swal(H.title,H.msg,H.status);else{var I=u();I=JSON.stringify(I),s(I,G)}}),'0'==a('#input_academics_saved').val()&&a('#save_academics_data').parent().show(),'1'==a('#input_academics_saved').val()&&(a('#save_academics_data').parent().hide(),a('#edit_academics_data').parent().show()),a('#save_academics_data').click(function(){var H=q();if('error'==H.status)swal(H.title,H.msg,H.status);else{var I=p();console.log(I),I=JSON.stringify(I),o(I,G)}}),a('#edit_academics_data').click(function(){var H=q();if('error'==H.status)swal(H.title,H.msg,H.status);else{var I=p();I=JSON.stringify(I),n(I,G)}}),a(document).on('click','#table_aspectos_instituciones tbody tr td button',function(){a(this).parent().parent().remove()}),a('#bt_add_institucion').click(function(){var H='';H+='<tr><td> <input name="name_institucion" class="input_fields_general_tab"  type="text"/></td>',H+='<td> <input name="nivel_academico_institucion" class="input_fields_general_tab"  type="text" /></td>',H+='<td> <input name="apoyos_institucion" class="input_fields_general_tab"  type="text" /></td>',H+='<td> <button type ="button" id="bt_delete_institucion" title="Eliminar instituci\xF3n" name="btn_delete_person" style="visibility:visible;"> </button></td> </tr>',a('#table_aspectos_instituciones').find('tbody').append(H)})}}});