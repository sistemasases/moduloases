{"version":3,"sources":["../src/buttons.flash.js"],"names":["factory","define","amd","$","window","document","exports","module","root","fn","dataTable","require","Buttons","jQuery","DataTable","ZeroClipboard_TableTools","version","clients","moviePath","nextId","thingy","getElementById","addClass","hide","style","display","show","name","removeClass","className","replace","RegExp","hasClass","match","setMoviePath","path","dispatch","id","eventName","args","client","receiveEvent","log","str","console","register","getDOMObjectPosition","obj","info","left","top","width","offsetWidth","height","offsetHeight","offsetLeft","offsetTop","offsetParent","Client","elem","handlers","movieId","glue","prototype","ready","movie","clipText","fileName","action","handCursorEnabled","cssEffects","sized","sheetName","title","domElement","zIndex","parseInt","box","div","createElement","position","appendChild","innerHTML","getHTML","positionElement","flash","childNodes","html","flashvars","navigator","userAgent","protocol","location","href","reposition","destroy","that","remove","each","clearText","appendText","newText","setText","setFileName","setSheetData","data","JSON","stringify","setAction","addEventListener","func","toString","toLowerCase","push","setHandCursor","enabled","setCSSEffects","self","setTimeout","recoverActive","idx","len","length","hasFlash","fo","ActiveXObject","e","mimeTypes","enabledPlugin","_glue","node","attr","parents","_sheetname","config","_setText","parts","i","_newLine","newline","_exportData","dt","newLine","buttons","exportData","exportOptions","boundary","fieldBoundary","separator","fieldSeparator","reBoundary","escapeChar","join","a","s","ien","header","footer","body","rows","flashButton","available","init","button","swfPath","_fromFlash","trigger","_flash","messageTop","messageBottom","filename","extension","createCellPos","n","String","fromCharCode","Math","floor","_createNode","doc","nodeName","opts","tempNode","children","key","value","text","createTextNode","_excelColWidth","col","max","lineSplit","point","indexOf","split","sort","b","_serialiser","XMLSerializer","serializeToString","input","xml","_ieExcel","_xlsxToStrings","parseXML","excelStrings","val","isPlainObject","worksheet","attrs","attributes","attrName","attrValue","nodeValue","removeAttribute","createAttribute","setAttributeNode","_excelSpecials","fmt","d","Api","parentNode","ext","copyFlash","extend","i18n","processing","exportInfo","output","customize","_","csvFlash","_filename","excelFlash","rowPos","rels","relsGet","getElementsByTagName","xlsx","_rels","xl","currentRow","rowNode","addRow","row","r","cellId","cell","createEmptyCells","trim","j","jen","special","t","customizeData","mergeCells","colspan","ref","ie","cols","prepend","min","customWidth","pdfFlash","totalWidth","table","ratios","columns","indexes","map","column","colWidth","toArray","orientation","size","pageSize"],"mappings":"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","sourcesContent":["/*!\n * Flash export buttons for Buttons and DataTables.\n * 2015-2017 SpryMedia Ltd - datatables.net/license\n *\n * ZeroClipbaord - MIT license\n * Copyright (c) 2012 Joseph Huckaby\n */\n\n(function( factory ){\n\tif ( typeof define === 'function' && define.amd ) {\n\t\t// AMD\n\t\tdefine( ['jquery', 'block_ases/jquery.dataTables', 'block_ases/dataTables.buttons'], function ( $ ) {\n\t\t\treturn factory( $, window, document );\n\t\t} );\n\t}\n\telse if ( typeof exports === 'object' ) {\n\t\t// CommonJS\n\t\tmodule.exports = function (root, $) {\n\t\t\tif ( ! root ) {\n\t\t\t\troot = window;\n\t\t\t}\n\n\t\t\tif ( ! $ || ! $.fn.dataTable ) {\n\t\t\t\t$ = require('block_ases/jquery.dataTables')(root, $).$;\n\t\t\t}\n\n\t\t\tif ( ! $.fn.dataTable.Buttons ) {\n\t\t\t\trequire('block_ases/dataTables.buttons')(root, $);\n\t\t\t}\n\n\t\t\treturn factory( $, root, root.document );\n\t\t};\n\t}\n\telse {\n\t\t// Browser\n\t\tfactory( jQuery, window, document );\n\t}\n}(function( $, window, document, undefined ) {\n'use strict';\nvar DataTable = $.fn.dataTable;\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * ZeroClipboard dependency\n */\n\n/*\n * ZeroClipboard 1.0.4 with modifications\n * Author: Joseph Huckaby\n * License: MIT\n *\n * Copyright (c) 2012 Joseph Huckaby\n */\nvar ZeroClipboard_TableTools = {\n\tversion: \"1.0.4-TableTools2\",\n\tclients: {}, // registered upload clients on page, indexed by id\n\tmoviePath: '', // URL to movie\n\tnextId: 1, // ID of next movie\n\n\t$: function(thingy) {\n\t\t// simple DOM lookup utility function\n\t\tif (typeof(thingy) == 'string') {\n\t\t\tthingy = document.getElementById(thingy);\n\t\t}\n\t\tif (!thingy.addClass) {\n\t\t\t// extend element with a few useful methods\n\t\t\tthingy.hide = function() { this.style.display = 'none'; };\n\t\t\tthingy.show = function() { this.style.display = ''; };\n\t\t\tthingy.addClass = function(name) { this.removeClass(name); this.className += ' ' + name; };\n\t\t\tthingy.removeClass = function(name) {\n\t\t\t\tthis.className = this.className.replace( new RegExp(\"\\\\s*\" + name + \"\\\\s*\"), \" \").replace(/^\\s+/, '').replace(/\\s+$/, '');\n\t\t\t};\n\t\t\tthingy.hasClass = function(name) {\n\t\t\t\treturn !!this.className.match( new RegExp(\"\\\\s*\" + name + \"\\\\s*\") );\n\t\t\t};\n\t\t}\n\t\treturn thingy;\n\t},\n\n\tsetMoviePath: function(path) {\n\t\t// set path to ZeroClipboard.swf\n\t\tthis.moviePath = path;\n\t},\n\n\tdispatch: function(id, eventName, args) {\n\t\t// receive event from flash movie, send to client\n\t\tvar client = this.clients[id];\n\t\tif (client) {\n\t\t\tclient.receiveEvent(eventName, args);\n\t\t}\n\t},\n\n\tlog: function ( str ) {\n\t\tconsole.log( 'Flash: '+str );\n\t},\n\n\tregister: function(id, client) {\n\t\t// register new client to receive events\n\t\tthis.clients[id] = client;\n\t},\n\n\tgetDOMObjectPosition: function(obj) {\n\t\t// get absolute coordinates for dom element\n\t\tvar info = {\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t\twidth: obj.width ? obj.width : obj.offsetWidth,\n\t\t\theight: obj.height ? obj.height : obj.offsetHeight\n\t\t};\n\n\t\tif ( obj.style.width !== \"\" ) {\n\t\t\tinfo.width = obj.style.width.replace(\"px\",\"\");\n\t\t}\n\n\t\tif ( obj.style.height !== \"\" ) {\n\t\t\tinfo.height = obj.style.height.replace(\"px\",\"\");\n\t\t}\n\n\t\twhile (obj) {\n\t\t\tinfo.left += obj.offsetLeft;\n\t\t\tinfo.top += obj.offsetTop;\n\t\t\tobj = obj.offsetParent;\n\t\t}\n\n\t\treturn info;\n\t},\n\n\tClient: function(elem) {\n\t\t// constructor for new simple upload client\n\t\tthis.handlers = {};\n\n\t\t// unique ID\n\t\tthis.id = ZeroClipboard_TableTools.nextId++;\n\t\tthis.movieId = 'ZeroClipboard_TableToolsMovie_' + this.id;\n\n\t\t// register client with singleton to receive flash events\n\t\tZeroClipboard_TableTools.register(this.id, this);\n\n\t\t// create movie\n\t\tif (elem) {\n\t\t\tthis.glue(elem);\n\t\t}\n\t}\n};\n\nZeroClipboard_TableTools.Client.prototype = {\n\n\tid: 0, // unique ID for us\n\tready: false, // whether movie is ready to receive events or not\n\tmovie: null, // reference to movie object\n\tclipText: '', // text to copy to clipboard\n\tfileName: '', // default file save name\n\taction: 'copy', // action to perform\n\thandCursorEnabled: true, // whether to show hand cursor, or default pointer cursor\n\tcssEffects: true, // enable CSS mouse effects on dom container\n\thandlers: null, // user event handlers\n\tsized: false,\n\tsheetName: '', // default sheet name for excel export\n\n\tglue: function(elem, title) {\n\t\t// glue to DOM element\n\t\t// elem can be ID or actual DOM element object\n\t\tthis.domElement = ZeroClipboard_TableTools.$(elem);\n\n\t\t// float just above object, or zIndex 99 if dom element isn't set\n\t\tvar zIndex = 99;\n\t\tif (this.domElement.style.zIndex) {\n\t\t\tzIndex = parseInt(this.domElement.style.zIndex, 10) + 1;\n\t\t}\n\n\t\t// find X/Y position of domElement\n\t\tvar box = ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement);\n\n\t\t// create floating DIV above element\n\t\tthis.div = document.createElement('div');\n\t\tvar style = this.div.style;\n\t\tstyle.position = 'absolute';\n\t\tstyle.left = '0px';\n\t\tstyle.top = '0px';\n\t\tstyle.width = (box.width) + 'px';\n\t\tstyle.height = box.height + 'px';\n\t\tstyle.zIndex = zIndex;\n\n\t\tif ( typeof title != \"undefined\" && title !== \"\" ) {\n\t\t\tthis.div.title = title;\n\t\t}\n\t\tif ( box.width !== 0 && box.height !== 0 ) {\n\t\t\tthis.sized = true;\n\t\t}\n\n\t\t// style.backgroundColor = '#f00'; // debug\n\t\tif ( this.domElement ) {\n\t\t\tthis.domElement.appendChild(this.div);\n\t\t\tthis.div.innerHTML = this.getHTML( box.width, box.height ).replace(/&/g, '&amp;');\n\t\t}\n\t},\n\n\tpositionElement: function() {\n\t\tvar box = ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement);\n\t\tvar style = this.div.style;\n\n\t\tstyle.position = 'absolute';\n\t\t//style.left = (this.domElement.offsetLeft)+'px';\n\t\t//style.top = this.domElement.offsetTop+'px';\n\t\tstyle.width = box.width + 'px';\n\t\tstyle.height = box.height + 'px';\n\n\t\tif ( box.width !== 0 && box.height !== 0 ) {\n\t\t\tthis.sized = true;\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\tvar flash = this.div.childNodes[0];\n\t\tflash.width = box.width;\n\t\tflash.height = box.height;\n\t},\n\n\tgetHTML: function(width, height) {\n\t\t// return HTML for movie\n\t\tvar html = '';\n\t\tvar flashvars = 'id=' + this.id +\n\t\t\t'&width=' + width +\n\t\t\t'&height=' + height;\n\n\t\tif (navigator.userAgent.match(/MSIE/)) {\n\t\t\t// IE gets an OBJECT tag\n\t\t\tvar protocol = location.href.match(/^https/i) ? 'https://' : 'http://';\n\t\t\thtml += '<object classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" codebase=\"'+protocol+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0\" width=\"'+width+'\" height=\"'+height+'\" id=\"'+this.movieId+'\" align=\"middle\"><param name=\"allowScriptAccess\" value=\"always\" /><param name=\"allowFullScreen\" value=\"false\" /><param name=\"movie\" value=\"'+ZeroClipboard_TableTools.moviePath+'\" /><param name=\"loop\" value=\"false\" /><param name=\"menu\" value=\"false\" /><param name=\"quality\" value=\"best\" /><param name=\"bgcolor\" value=\"#ffffff\" /><param name=\"flashvars\" value=\"'+flashvars+'\"/><param name=\"wmode\" value=\"transparent\"/></object>';\n\t\t}\n\t\telse {\n\t\t\t// all other browsers get an EMBED tag\n\t\t\thtml += '<embed id=\"'+this.movieId+'\" src=\"'+ZeroClipboard_TableTools.moviePath+'\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"'+width+'\" height=\"'+height+'\" name=\"'+this.movieId+'\" align=\"middle\" allowScriptAccess=\"always\" allowFullScreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"'+flashvars+'\" wmode=\"transparent\" />';\n\t\t}\n\t\treturn html;\n\t},\n\n\thide: function() {\n\t\t// temporarily hide floater offscreen\n\t\tif (this.div) {\n\t\t\tthis.div.style.left = '-2000px';\n\t\t}\n\t},\n\n\tshow: function() {\n\t\t// show ourselves after a call to hide()\n\t\tthis.reposition();\n\t},\n\n\tdestroy: function() {\n\t\t// destroy control and floater\n\t\tvar that = this;\n\n\t\tif (this.domElement && this.div) {\n\t\t\t$(this.div).remove();\n\n\t\t\tthis.domElement = null;\n\t\t\tthis.div = null;\n\n\t\t\t$.each( ZeroClipboard_TableTools.clients, function ( id, client ) {\n\t\t\t\tif ( client === that ) {\n\t\t\t\t\tdelete ZeroClipboard_TableTools.clients[ id ];\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t},\n\n\treposition: function(elem) {\n\t\t// reposition our floating div, optionally to new container\n\t\t// warning: container CANNOT change size, only position\n\t\tif (elem) {\n\t\t\tthis.domElement = ZeroClipboard_TableTools.$(elem);\n\t\t\tif (!this.domElement) {\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t}\n\n\t\tif (this.domElement && this.div) {\n\t\t\tvar box = ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement);\n\t\t\tvar style = this.div.style;\n\t\t\tstyle.left = '' + box.left + 'px';\n\t\t\tstyle.top = '' + box.top + 'px';\n\t\t}\n\t},\n\n\tclearText: function() {\n\t\t// clear the text to be copy / saved\n\t\tthis.clipText = '';\n\t\tif (this.ready) {\n\t\t\tthis.movie.clearText();\n\t\t}\n\t},\n\n\tappendText: function(newText) {\n\t\t// append text to that which is to be copied / saved\n\t\tthis.clipText += newText;\n\t\tif (this.ready) { this.movie.appendText(newText) ;}\n\t},\n\n\tsetText: function(newText) {\n\t\t// set text to be copied to be copied / saved\n\t\tthis.clipText = newText;\n\t\tif (this.ready) { this.movie.setText(newText) ;}\n\t},\n\n\tsetFileName: function(newText) {\n\t\t// set the file name\n\t\tthis.fileName = newText;\n\t\tif (this.ready) {\n\t\t\tthis.movie.setFileName(newText);\n\t\t}\n\t},\n\n\tsetSheetData: function(data) {\n\t\t// set the xlsx sheet data\n\t\tif (this.ready) {\n\t\t\tthis.movie.setSheetData( JSON.stringify( data ) );\n\t\t}\n\t},\n\n\tsetAction: function(newText) {\n\t\t// set action (save or copy)\n\t\tthis.action = newText;\n\t\tif (this.ready) {\n\t\t\tthis.movie.setAction(newText);\n\t\t}\n\t},\n\n\taddEventListener: function(eventName, func) {\n\t\t// add user event listener for event\n\t\t// event types: load, queueStart, fileStart, fileComplete, queueComplete, progress, error, cancel\n\t\teventName = eventName.toString().toLowerCase().replace(/^on/, '');\n\t\tif (!this.handlers[eventName]) {\n\t\t\tthis.handlers[eventName] = [];\n\t\t}\n\t\tthis.handlers[eventName].push(func);\n\t},\n\n\tsetHandCursor: function(enabled) {\n\t\t// enable hand cursor (true), or default arrow cursor (false)\n\t\tthis.handCursorEnabled = enabled;\n\t\tif (this.ready) {\n\t\t\tthis.movie.setHandCursor(enabled);\n\t\t}\n\t},\n\n\tsetCSSEffects: function(enabled) {\n\t\t// enable or disable CSS effects on DOM container\n\t\tthis.cssEffects = !!enabled;\n\t},\n\n\treceiveEvent: function(eventName, args) {\n\t\tvar self;\n\n\t\t// receive event from flash\n\t\teventName = eventName.toString().toLowerCase().replace(/^on/, '');\n\n\t\t// special behavior for certain events\n\t\tswitch (eventName) {\n\t\t\tcase 'load':\n\t\t\t\t// movie claims it is ready, but in IE this isn't always the case...\n\t\t\t\t// bug fix: Cannot extend EMBED DOM elements in Firefox, must use traditional function\n\t\t\t\tthis.movie = document.getElementById(this.movieId);\n\t\t\t\tif (!this.movie) {\n\t\t\t\t\tself = this;\n\t\t\t\t\tsetTimeout( function() { self.receiveEvent('load', null); }, 1 );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// firefox on pc needs a \"kick\" in order to set these in certain cases\n\t\t\t\tif (!this.ready && navigator.userAgent.match(/Firefox/) && navigator.userAgent.match(/Windows/)) {\n\t\t\t\t\tself = this;\n\t\t\t\t\tsetTimeout( function() { self.receiveEvent('load', null); }, 100 );\n\t\t\t\t\tthis.ready = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.ready = true;\n\t\t\t\tthis.movie.clearText();\n\t\t\t\tthis.movie.appendText( this.clipText );\n\t\t\t\tthis.movie.setFileName( this.fileName );\n\t\t\t\tthis.movie.setAction( this.action );\n\t\t\t\tthis.movie.setHandCursor( this.handCursorEnabled );\n\t\t\t\tbreak;\n\n\t\t\tcase 'mouseover':\n\t\t\t\tif (this.domElement && this.cssEffects) {\n\t\t\t\t\t//this.domElement.addClass('hover');\n\t\t\t\t\tif (this.recoverActive) {\n\t\t\t\t\t\tthis.domElement.addClass('active');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'mouseout':\n\t\t\t\tif (this.domElement && this.cssEffects) {\n\t\t\t\t\tthis.recoverActive = false;\n\t\t\t\t\tif (this.domElement.hasClass('active')) {\n\t\t\t\t\t\tthis.domElement.removeClass('active');\n\t\t\t\t\t\tthis.recoverActive = true;\n\t\t\t\t\t}\n\t\t\t\t\t//this.domElement.removeClass('hover');\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'mousedown':\n\t\t\t\tif (this.domElement && this.cssEffects) {\n\t\t\t\t\tthis.domElement.addClass('active');\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'mouseup':\n\t\t\t\tif (this.domElement && this.cssEffects) {\n\t\t\t\t\tthis.domElement.removeClass('active');\n\t\t\t\t\tthis.recoverActive = false;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t} // switch eventName\n\n\t\tif (this.handlers[eventName]) {\n\t\t\tfor (var idx = 0, len = this.handlers[eventName].length; idx < len; idx++) {\n\t\t\t\tvar func = this.handlers[eventName][idx];\n\n\t\t\t\tif (typeof(func) == 'function') {\n\t\t\t\t\t// actual function reference\n\t\t\t\t\tfunc(this, args);\n\t\t\t\t}\n\t\t\t\telse if ((typeof(func) == 'object') && (func.length == 2)) {\n\t\t\t\t\t// PHP style object + method, i.e. [myObject, 'myMethod']\n\t\t\t\t\tfunc[0][ func[1] ](this, args);\n\t\t\t\t}\n\t\t\t\telse if (typeof(func) == 'string') {\n\t\t\t\t\t// name of function\n\t\t\t\t\twindow[func](this, args);\n\t\t\t\t}\n\t\t\t} // foreach event handler defined\n\t\t} // user defined handler for event\n\t}\n};\n\nZeroClipboard_TableTools.hasFlash = function ()\n{\n\ttry {\n\t\tvar fo = new ActiveXObject('ShockwaveFlash.ShockwaveFlash');\n\t\tif (fo) {\n\t\t\treturn true;\n\t\t}\n\t}\n\tcatch (e) {\n\t\tif (\n\t\t\tnavigator.mimeTypes &&\n\t\t\tnavigator.mimeTypes['application/x-shockwave-flash'] !== undefined &&\n\t\t\tnavigator.mimeTypes['application/x-shockwave-flash'].enabledPlugin\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n};\n\n// For the Flash binding to work, ZeroClipboard_TableTools must be on the global\n// object list\nwindow.ZeroClipboard_TableTools = ZeroClipboard_TableTools;\n\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * Local (private) functions\n */\n\n/**\n * If a Buttons instance is initlaised before it is placed into the DOM, Flash\n * won't be able to bind to it, so we need to wait until it is available, this\n * method abstracts that out.\n *\n * @param {ZeroClipboard} flash ZeroClipboard instance\n * @param {jQuery} node  Button\n */\nvar _glue = function ( flash, node )\n{\n\tvar id = node.attr('id');\n\n\tif ( node.parents('html').length ) {\n\t\tflash.glue( node[0], '' );\n\t}\n\telse {\n\t\tsetTimeout( function () {\n\t\t\t_glue( flash, node );\n\t\t}, 500 );\n\t}\n};\n\n/**\n * Get the sheet name for Excel exports.\n *\n * @param {object}  config       Button configuration\n */\nvar _sheetname = function ( config )\n{\n\tvar sheetName = 'Sheet1';\n\n\tif ( config.sheetName ) {\n\t\tsheetName = config.sheetName.replace(/[\\[\\]\\*\\/\\\\\\?\\:]/g, '');\n\t}\n\n\treturn sheetName;\n};\n\n/**\n * Set the flash text. This has to be broken up into chunks as the Javascript /\n * Flash bridge has a size limit. There is no indication in the Flash\n * documentation what this is, and it probably depends upon the browser.\n * Experimentation shows that the point is around 50k when data starts to get\n * lost, so an 8K limit used here is safe.\n *\n * @param {ZeroClipboard} flash ZeroClipboard instance\n * @param {string}        data  Data to send to Flash\n */\nvar _setText = function ( flash, data )\n{\n\tvar parts = data.match(/[\\s\\S]{1,8192}/g) || [];\n\n\tflash.clearText();\n\tfor ( var i=0, len=parts.length ; i<len ; i++ )\n\t{\n\t\tflash.appendText( parts[i] );\n\t}\n};\n\n/**\n * Get the newline character(s)\n *\n * @param {object}  config Button configuration\n * @return {string}        Newline character\n */\nvar _newLine = function ( config )\n{\n\treturn config.newline ?\n\t\tconfig.newline :\n\t\tnavigator.userAgent.match(/Windows/) ?\n\t\t\t'\\r\\n' :\n\t\t\t'\\n';\n};\n\n/**\n * Combine the data from the `buttons.exportData` method into a string that\n * will be used in the export file.\n *\n * @param  {DataTable.Api} dt     DataTables API instance\n * @param  {object}        config Button configuration\n * @return {object}               The data to export\n */\nvar _exportData = function ( dt, config )\n{\n\tvar newLine = _newLine( config );\n\tvar data = dt.buttons.exportData( config.exportOptions );\n\tvar boundary = config.fieldBoundary;\n\tvar separator = config.fieldSeparator;\n\tvar reBoundary = new RegExp( boundary, 'g' );\n\tvar escapeChar = config.escapeChar !== undefined ?\n\t\tconfig.escapeChar :\n\t\t'\\\\';\n\tvar join = function ( a ) {\n\t\tvar s = '';\n\n\t\t// If there is a field boundary, then we might need to escape it in\n\t\t// the source data\n\t\tfor ( var i=0, ien=a.length ; i<ien ; i++ ) {\n\t\t\tif ( i > 0 ) {\n\t\t\t\ts += separator;\n\t\t\t}\n\n\t\t\ts += boundary ?\n\t\t\t\tboundary + ('' + a[i]).replace( reBoundary, escapeChar+boundary ) + boundary :\n\t\t\t\ta[i];\n\t\t}\n\n\t\treturn s;\n\t};\n\n\tvar header = config.header ? join( data.header )+newLine : '';\n\tvar footer = config.footer && data.footer ? newLine+join( data.footer ) : '';\n\tvar body = [];\n\n\tfor ( var i=0, ien=data.body.length ; i<ien ; i++ ) {\n\t\tbody.push( join( data.body[i] ) );\n\t}\n\n\treturn {\n\t\tstr: header + body.join( newLine ) + footer,\n\t\trows: body.length\n\t};\n};\n\n\n// Basic initialisation for the buttons is common between them\nvar flashButton = {\n\tavailable: function () {\n\t\treturn ZeroClipboard_TableTools.hasFlash();\n\t},\n\n\tinit: function ( dt, button, config ) {\n\t\t// Insert the Flash movie\n\t\tZeroClipboard_TableTools.moviePath = DataTable.Buttons.swfPath;\n\t\tvar flash = new ZeroClipboard_TableTools.Client();\n\n\t\tflash.setHandCursor( true );\n\t\tflash.addEventListener('mouseDown', function(client) {\n\t\t\tconfig._fromFlash = true;\n\t\t\tdt.button( button[0] ).trigger();\n\t\t\tconfig._fromFlash = false;\n\t\t} );\n\n\t\t_glue( flash, button );\n\n\t\tconfig._flash = flash;\n\t},\n\n\tdestroy: function ( dt, button, config ) {\n\t\tconfig._flash.destroy();\n\t},\n\n\tfieldSeparator: ',',\n\n\tfieldBoundary: '\"',\n\n\texportOptions: {},\n\n\ttitle: '*',\n\n\tmessageTop: '*',\n\n\tmessageBottom: '*',\n\n\tfilename: '*',\n\n\textension: '.csv',\n\n\theader: true,\n\n\tfooter: false\n};\n\n\n/**\n * Convert from numeric position to letter for column names in Excel\n * @param  {int} n Column number\n * @return {string} Column letter(s) name\n */\nfunction createCellPos( n ){\n\tvar ordA = 'A'.charCodeAt(0);\n\tvar ordZ = 'Z'.charCodeAt(0);\n\tvar len = ordZ - ordA + 1;\n\tvar s = \"\";\n\n\twhile( n >= 0 ) {\n\t\ts = String.fromCharCode(n % len + ordA) + s;\n\t\tn = Math.floor(n / len) - 1;\n\t}\n\n\treturn s;\n}\n\n/**\n * Create an XML node and add any children, attributes, etc without needing to\n * be verbose in the DOM.\n *\n * @param  {object} doc      XML document\n * @param  {string} nodeName Node name\n * @param  {object} opts     Options - can be `attr` (attributes), `children`\n *   (child nodes) and `text` (text content)\n * @return {node}            Created node\n */\nfunction _createNode( doc, nodeName, opts ){\n\tvar tempNode = doc.createElement( nodeName );\n\n\tif ( opts ) {\n\t\tif ( opts.attr ) {\n\t\t\t$(tempNode).attr( opts.attr );\n\t\t}\n\n\t\tif ( opts.children ) {\n\t\t\t$.each( opts.children, function ( key, value ) {\n\t\t\t\ttempNode.appendChild( value );\n\t\t\t} );\n\t\t}\n\n\t\tif ( opts.text !== null && opts.text !== undefined ) {\n\t\t\ttempNode.appendChild( doc.createTextNode( opts.text ) );\n\t\t}\n\t}\n\n\treturn tempNode;\n}\n\n/**\n * Get the width for an Excel column based on the contents of that column\n * @param  {object} data Data for export\n * @param  {int}    col  Column index\n * @return {int}         Column width\n */\nfunction _excelColWidth( data, col ) {\n\tvar max = data.header[col].length;\n\tvar len, lineSplit, str;\n\n\tif ( data.footer && data.footer[col].length > max ) {\n\t\tmax = data.footer[col].length;\n\t}\n\n\tfor ( var i=0, ien=data.body.length ; i<ien ; i++ ) {\n\t\tvar point = data.body[i][col];\n\t\tstr = point !== null && point !== undefined ?\n\t\t\tpoint.toString() :\n\t\t\t'';\n\n\t\t// If there is a newline character, workout the width of the column\n\t\t// based on the longest line in the string\n\t\tif ( str.indexOf('\\n') !== -1 ) {\n\t\t\tlineSplit = str.split('\\n');\n\t\t\tlineSplit.sort( function (a, b) {\n\t\t\t\treturn b.length - a.length;\n\t\t\t} );\n\n\t\t\tlen = lineSplit[0].length;\n\t\t}\n\t\telse {\n\t\t\tlen = str.length;\n\t\t}\n\n\t\tif ( len > max ) {\n\t\t\tmax = len;\n\t\t}\n\n\t\t// Max width rather than having potentially massive column widths\n\t\tif ( max > 40 ) {\n\t\t\treturn 52; // 40 * 1.3\n\t\t}\n\t}\n\n\tmax *= 1.3;\n\n\t// And a min width\n\treturn max > 6 ? max : 6;\n}\n\n  var _serialiser = \"\";\n    if (typeof window.XMLSerializer === 'undefined') {\n        _serialiser = new function () {\n            this.serializeToString = function (input) {\n                return input.xml\n            }\n        };\n    } else {\n        _serialiser =  new XMLSerializer();\n    }\n\n    var _ieExcel;\n\n\n/**\n * Convert XML documents in an object to strings\n * @param  {object} obj XLSX document object\n */\nfunction _xlsxToStrings( obj ) {\n\tif ( _ieExcel === undefined ) {\n\t\t// Detect if we are dealing with IE's _awful_ serialiser by seeing if it\n\t\t// drop attributes\n\t\t_ieExcel = _serialiser\n\t\t\t.serializeToString(\n\t\t\t\t$.parseXML( excelStrings['xl/worksheets/sheet1.xml'] )\n\t\t\t)\n\t\t\t.indexOf( 'xmlns:r' ) === -1;\n\t}\n\n\t$.each( obj, function ( name, val ) {\n\t\tif ( $.isPlainObject( val ) ) {\n\t\t\t_xlsxToStrings( val );\n\t\t}\n\t\telse {\n\t\t\tif ( _ieExcel ) {\n\t\t\t\t// IE's XML serialiser will drop some name space attributes from\n\t\t\t\t// from the root node, so we need to save them. Do this by\n\t\t\t\t// replacing the namespace nodes with a regular attribute that\n\t\t\t\t// we convert back when serialised. Edge does not have this\n\t\t\t\t// issue\n\t\t\t\tvar worksheet = val.childNodes[0];\n\t\t\t\tvar i, ien;\n\t\t\t\tvar attrs = [];\n\n\t\t\t\tfor ( i=worksheet.attributes.length-1 ; i>=0 ; i-- ) {\n\t\t\t\t\tvar attrName = worksheet.attributes[i].nodeName;\n\t\t\t\t\tvar attrValue = worksheet.attributes[i].nodeValue;\n\n\t\t\t\t\tif ( attrName.indexOf( ':' ) !== -1 ) {\n\t\t\t\t\t\tattrs.push( { name: attrName, value: attrValue } );\n\n\t\t\t\t\t\tworksheet.removeAttribute( attrName );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor ( i=0, ien=attrs.length ; i<ien ; i++ ) {\n\t\t\t\t\tvar attr = val.createAttribute( attrs[i].name.replace( ':', '_dt_b_namespace_token_' ) );\n\t\t\t\t\tattr.value = attrs[i].value;\n\t\t\t\t\tworksheet.setAttributeNode( attr );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar str = _serialiser.serializeToString(val);\n\n\t\t\t// Fix IE's XML\n\t\t\tif ( _ieExcel ) {\n\t\t\t\t// IE doesn't include the XML declaration\n\t\t\t\tif ( str.indexOf( '<?xml' ) === -1 ) {\n\t\t\t\t\tstr = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+str;\n\t\t\t\t}\n\n\t\t\t\t// Return namespace attributes to being as such\n\t\t\t\tstr = str.replace( /_dt_b_namespace_token_/g, ':' );\n\t\t\t}\n\n\t\t\t// Safari, IE and Edge will put empty name space attributes onto\n\t\t\t// various elements making them useless. This strips them out\n\t\t\tstr = str.replace( /<([^<>]*?) xmlns=\"\"([^<>]*?)>/g, '<$1 $2>' );\n\n\t\t\tobj[ name ] = str;\n\t\t}\n\t} );\n}\n\n// Excel - Pre-defined strings to build a basic XLSX file\nvar excelStrings = {\n\t\"_rels/.rels\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'+\n\t\t\t'<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/>'+\n\t\t'</Relationships>',\n\n\t\"xl/_rels/workbook.xml.rels\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'+\n\t\t\t'<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/>'+\n\t\t\t'<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>'+\n\t\t'</Relationships>',\n\n\t\"[Content_Types].xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">'+\n\t\t\t'<Default Extension=\"xml\" ContentType=\"application/xml\" />'+\n\t\t\t'<Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" />'+\n\t\t\t'<Default Extension=\"jpeg\" ContentType=\"image/jpeg\" />'+\n\t\t\t'<Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\" />'+\n\t\t\t'<Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\" />'+\n\t\t\t'<Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\" />'+\n\t\t'</Types>',\n\n\t\"xl/workbook.xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">'+\n\t\t\t'<fileVersion appName=\"xl\" lastEdited=\"5\" lowestEdited=\"5\" rupBuild=\"24816\"/>'+\n\t\t\t'<workbookPr showInkAnnotation=\"0\" autoCompressPictures=\"0\"/>'+\n\t\t\t'<bookViews>'+\n\t\t\t\t'<workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"25600\" windowHeight=\"19020\" tabRatio=\"500\"/>'+\n\t\t\t'</bookViews>'+\n\t\t\t'<sheets>'+\n\t\t\t\t'<sheet name=\"\" sheetId=\"1\" r:id=\"rId1\"/>'+\n\t\t\t'</sheets>'+\n\t\t'</workbook>',\n\n\t\"xl/worksheets/sheet1.xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">'+\n\t\t\t'<sheetData/>'+\n\t\t\t'<mergeCells count=\"0\"/>'+\n\t\t'</worksheet>',\n\n\t\"xl/styles.xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\"?>'+\n\t\t'<styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">'+\n\t\t\t'<numFmts count=\"6\">'+\n\t\t\t\t'<numFmt numFmtId=\"164\" formatCode=\"#,##0.00_-\\ [$$-45C]\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"165\" formatCode=\"&quot;&quot;#,##0.00\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"166\" formatCode=\"[$-2]\\ #,##0.00\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"167\" formatCode=\"0.0%\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"168\" formatCode=\"#,##0;(#,##0)\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"169\" formatCode=\"#,##0.00;(#,##0.00)\"/>'+\n\t\t\t'</numFmts>'+\n\t\t\t'<fonts count=\"5\" x14ac:knownFonts=\"1\">'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<color rgb=\"FFFFFFFF\" />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<b />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<i />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<u />'+\n\t\t\t\t'</font>'+\n\t\t\t'</fonts>'+\n\t\t\t'<fills count=\"6\">'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"none\" />'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+ // Excel appears to use this as a dotted background regardless of values but\n\t\t\t\t\t'<patternFill patternType=\"none\" />'+ // to be valid to the schema, use a patternFill\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"FFD9D9D9\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"FFD99795\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"ffc6efce\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"ffc6cfef\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t'</fills>'+\n\t\t\t'<borders count=\"2\">'+\n\t\t\t\t'<border>'+\n\t\t\t\t\t'<left />'+\n\t\t\t\t\t'<right />'+\n\t\t\t\t\t'<top />'+\n\t\t\t\t\t'<bottom />'+\n\t\t\t\t\t'<diagonal />'+\n\t\t\t\t'</border>'+\n\t\t\t\t'<border diagonalUp=\"false\" diagonalDown=\"false\">'+\n\t\t\t\t\t'<left style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</left>'+\n\t\t\t\t\t'<right style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</right>'+\n\t\t\t\t\t'<top style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</top>'+\n\t\t\t\t\t'<bottom style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</bottom>'+\n\t\t\t\t\t'<diagonal />'+\n\t\t\t\t'</border>'+\n\t\t\t'</borders>'+\n\t\t\t'<cellStyleXfs count=\"1\">'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" />'+\n\t\t\t'</cellStyleXfs>'+\n\t\t\t'<cellXfs count=\"61\">'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"left\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"center\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"right\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"fill\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment textRotation=\"90\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment wrapText=\"1\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"9\"   fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"164\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"165\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"166\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"167\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"168\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"169\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"3\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"4\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t'</cellXfs>'+\n\t\t\t'<cellStyles count=\"1\">'+\n\t\t\t\t'<cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\" />'+\n\t\t\t'</cellStyles>'+\n\t\t\t'<dxfs count=\"0\" />'+\n\t\t\t'<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\" />'+\n\t\t'</styleSheet>'\n};\n// Note we could use 3 `for` loops for the styles, but when gzipped there is\n// virtually no difference in size, since the above can be easily compressed\n\n// Pattern matching for special number formats. Perhaps this should be exposed\n// via an API in future?\nvar _excelSpecials = [\n\t{ match: /^\\-?\\d+\\.\\d%$/,       style: 60, fmt: function (d) { return d/100; } }, // Precent with d.p.\n\t{ match: /^\\-?\\d+\\.?\\d*%$/,     style: 56, fmt: function (d) { return d/100; } }, // Percent\n\t{ match: /^\\-?\\$[\\d,]+.?\\d*$/,  style: 57 }, // Dollars\n\t{ match: /^\\-?[\\d,]+.?\\d*$/,   style: 58 }, // Pounds\n\t{ match: /^\\-?[\\d,]+.?\\d*$/,   style: 59 }, // Euros\n\t{ match: /^\\([\\d,]+\\)$/,        style: 61, fmt: function (d) { return -1 * d.replace(/[\\(\\)]/g, ''); } },  // Negative numbers indicated by brackets\n\t{ match: /^\\([\\d,]+\\.\\d{2}\\)$/, style: 62, fmt: function (d) { return -1 * d.replace(/[\\(\\)]/g, ''); } },  // Negative numbers indicated by brackets - 2d.p.\n\t{ match: /^[\\d,]+$/,            style: 63 }, // Numbers with thousand separators\n\t{ match: /^[\\d,]+\\.\\d{2}$/,     style: 64 }  // Numbers with 2d.p. and thousands separators\n];\n\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * DataTables options and methods\n */\n\n// Set the default SWF path\nDataTable.Buttons.swfPath = '../../style/swf/flasExport.swf';\n\n// Method to allow Flash buttons to be resized when made visible - as they are\n// of zero height and width if initialised hidden\nDataTable.Api.register( 'buttons.resize()', function () {\n\t$.each( ZeroClipboard_TableTools.clients, function ( i, client ) {\n\t\tif ( client.domElement !== undefined && client.domElement.parentNode ) {\n\t\t\tclient.positionElement();\n\t\t}\n\t} );\n} );\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * Button definitions\n */\n\n// Copy to clipboard\nDataTable.ext.buttons.copyFlash = $.extend( {}, flashButton, {\n\tclassName: 'buttons-copy buttons-flash',\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.copy', 'Copy' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\t// Check that the trigger did actually occur due to a Flash activation\n\t\tif ( ! config._fromFlash ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.processing( true );\n\n\t\tvar flash = config._flash;\n\t\tvar exportData = _exportData( dt, config );\n\t\tvar info = dt.buttons.exportInfo( config );\n\t\tvar newline = _newLine(config);\n\t\tvar output = exportData.str;\n\n\t\tif ( info.title ) {\n\t\t\toutput = info.title + newline + newline + output;\n\t\t}\n\n\t\tif ( info.messageTop ) {\n\t\t\toutput = info.messageTop + newline + newline + output;\n\t\t}\n\n\t\tif ( info.messageBottom ) {\n\t\t\toutput = output + newline + newline + info.messageBottom;\n\t\t}\n\n\t\tif ( config.customize ) {\n\t\t\toutput = config.customize( output, config );\n\t\t}\n\n\t\tflash.setAction( 'copy' );\n\t\t_setText( flash, output );\n\n\t\tthis.processing( false );\n\n\t\tdt.buttons.info(\n\t\t\tdt.i18n( 'buttons.copyTitle', 'Copy to clipboard' ),\n\t\t\tdt.i18n( 'buttons.copySuccess', {\n\t\t\t\t_: 'Copied %d rows to clipboard',\n\t\t\t\t1: 'Copied 1 row to clipboard'\n\t\t\t}, data.rows ),\n\t\t\t3000\n\t\t);\n\t},\n\n\tfieldSeparator: '\\t',\n\n\tfieldBoundary: ''\n} );\n\n// CSV save file\nDataTable.ext.buttons.csvFlash = $.extend( {}, flashButton, {\n\tclassName: 'buttons-csv buttons-flash',\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.csv', 'CSV' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\t// Set the text\n\t\tvar flash = config._flash;\n\t\tvar data = _exportData( dt, config );\n\t\tvar output = config.customize ?\n\t\t\tconfig.customize( data.str, config ) :\n\t\t\tdata.str;\n\n\t\tflash.setAction( 'csv' );\n\t\tflash.setFileName( _filename( config ) );\n\t\t_setText( flash, output );\n\t},\n\n\tescapeChar: '\"'\n} );\n\n// Excel save file - this is really a CSV file using UTF-8 that Excel can read\nDataTable.ext.buttons.excelFlash = $.extend( {}, flashButton, {\n\tclassName: 'buttons-excel buttons-flash',\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.excel', 'Excel' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\tthis.processing( true );\n\n\t\tvar flash = config._flash;\n\t\tvar rowPos = 0;\n\t\tvar rels = $.parseXML( excelStrings['xl/worksheets/sheet1.xml'] ) ; //Parses xml\n\t\tvar relsGet = rels.getElementsByTagName( \"sheetData\" )[0];\n\n\t\tvar xlsx = {\n\t\t\t_rels: {\n\t\t\t\t\".rels\": $.parseXML( excelStrings['_rels/.rels'] )\n\t\t\t},\n\t\t\txl: {\n\t\t\t\t_rels: {\n\t\t\t\t\t\"workbook.xml.rels\": $.parseXML( excelStrings['xl/_rels/workbook.xml.rels'] )\n\t\t\t\t},\n\t\t\t\t\"workbook.xml\": $.parseXML( excelStrings['xl/workbook.xml'] ),\n\t\t\t\t\"styles.xml\": $.parseXML( excelStrings['xl/styles.xml'] ),\n\t\t\t\t\"worksheets\": {\n\t\t\t\t\t\"sheet1.xml\": rels\n\t\t\t\t}\n\n\t\t\t},\n\t\t\t\"[Content_Types].xml\": $.parseXML( excelStrings['[Content_Types].xml'])\n\t\t};\n\n\t\tvar data = dt.buttons.exportData( config.exportOptions );\n\t\tvar currentRow, rowNode;\n\t\tvar addRow = function ( row ) {\n\t\t\tcurrentRow = rowPos+1;\n\t\t\trowNode = _createNode( rels, \"row\", { attr: {r:currentRow} } );\n\n\t\t\tfor ( var i=0, ien=row.length ; i<ien ; i++ ) {\n\t\t\t\t// Concat both the Cell Columns as a letter and the Row of the cell.\n\t\t\t\tvar cellId = createCellPos(i) + '' + currentRow;\n\t\t\t\tvar cell = null;\n\n\t\t\t\t// For null, undefined of blank cell, continue so it doesn't create the _createNode\n\t\t\t\tif ( row[i] === null || row[i] === undefined || row[i] === '' ) {\n\t\t\t\t\tif ( config.createEmptyCells === true ) {\n\t\t\t\t\t\trow[i] = '';\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trow[i] = $.trim( row[i] );\n\n\t\t\t\t// Special number formatting options\n\t\t\t\tfor ( var j=0, jen=_excelSpecials.length ; j<jen ; j++ ) {\n\t\t\t\t\tvar special = _excelSpecials[j];\n\n\t\t\t\t\t// TODO Need to provide the ability for the specials to say\n\t\t\t\t\t// if they are returning a string, since at the moment it is\n\t\t\t\t\t// assumed to be a number\n\t\t\t\t\tif ( row[i].match && ! row[i].match(/^0\\d+/) && row[i].match( special.match ) ) {\n\t\t\t\t\t\tvar val = row[i].replace(/[^\\d\\.\\-]/g, '');\n\n\t\t\t\t\t\tif ( special.fmt ) {\n\t\t\t\t\t\t\tval = special.fmt( val );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcell = _createNode( rels, 'c', {\n\t\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\t\tr: cellId,\n\t\t\t\t\t\t\t\ts: special.style\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t_createNode( rels, 'v', { text: val } )\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( ! cell ) {\n\t\t\t\t\tif ( typeof row[i] === 'number' || (\n\t\t\t\t\t\trow[i].match &&\n\t\t\t\t\t\trow[i].match(/^-?\\d+(\\.\\d+)?$/) &&\n\t\t\t\t\t\t! row[i].match(/^0\\d+/) )\n\t\t\t\t\t) {\n\t\t\t\t\t\t// Detect numbers - don't match numbers with leading zeros\n\t\t\t\t\t\t// or a negative anywhere but the start\n\t\t\t\t\t\tcell = _createNode( rels, 'c', {\n\t\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\t\tt: 'n',\n\t\t\t\t\t\t\t\tr: cellId\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t_createNode( rels, 'v', { text: row[i] } )\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// String output - replace non standard characters for text output\n\t\t\t\t\t\tvar text = ! row[i].replace ?\n\t\t\t\t\t\t\trow[i] :\n\t\t\t\t\t\t\trow[i].replace(/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x9F]/g, '');\n\n\t\t\t\t\t\tcell = _createNode( rels, 'c', {\n\t\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\t\tt: 'inlineStr',\n\t\t\t\t\t\t\t\tr: cellId\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren:{\n\t\t\t\t\t\t\t\trow: _createNode( rels, 'is', {\n\t\t\t\t\t\t\t\t\tchildren: {\n\t\t\t\t\t\t\t\t\t\trow: _createNode( rels, 't', {\n\t\t\t\t\t\t\t\t\t\t\ttext: text\n\t\t\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trowNode.appendChild( cell );\n\t\t\t}\n\n\t\t\trelsGet.appendChild(rowNode);\n\t\t\trowPos++;\n\t\t};\n\n\t\t$( 'sheets sheet', xlsx.xl['workbook.xml'] ).attr( 'name', _sheetname( config ) );\n\n\t\tif ( config.customizeData ) {\n\t\t\tconfig.customizeData( data );\n\t\t}\n\n\t\tvar mergeCells = function ( row, colspan ) {\n\t\t\tvar mergeCells = $('mergeCells', rels);\n\n\t\t\tmergeCells[0].appendChild( _createNode( rels, 'mergeCell', {\n\t\t\t\tattr: {\n\t\t\t\t\tref: 'A'+row+':'+createCellPos(colspan)+row\n\t\t\t\t}\n\t\t\t} ) );\n\t\t\tmergeCells.attr( 'count', mergeCells.attr( 'count' )+1 );\n\t\t\t$('row:eq('+(row-1)+') c', rels).attr( 's', '51' ); // centre\n\t\t};\n\n\t\t// Title and top messages\n\t\tvar exportInfo = dt.buttons.exportInfo( config );\n\t\tif ( exportInfo.title ) {\n\t\t\taddRow( [exportInfo.title], rowPos );\n\t\t\tmergeCells( rowPos, data.header.length-1 );\n\t\t}\n\n\t\tif ( exportInfo.messageTop ) {\n\t\t\taddRow( [exportInfo.messageTop], rowPos );\n\t\t\tmergeCells( rowPos, data.header.length-1 );\n\t\t}\n\n\t\t// Table itself\n\t\tif ( config.header ) {\n\t\t\taddRow( data.header, rowPos );\n\t\t\t$('row:last c', rels).attr( 's', '2' ); // bold\n\t\t}\n\n\t\tfor ( var n=0, ie=data.body.length ; n<ie ; n++ ) {\n\t\t\taddRow( data.body[n], rowPos );\n\t\t}\n\n\t\tif ( config.footer && data.footer ) {\n\t\t\taddRow( data.footer, rowPos);\n\t\t\t$('row:last c', rels).attr( 's', '2' ); // bold\n\t\t}\n\n\t\t// Below the table\n\t\tif ( exportInfo.messageBottom ) {\n\t\t\taddRow( [exportInfo.messageBottom], rowPos );\n\t\t\tmergeCells( rowPos, data.header.length-1 );\n\t\t}\n\n\t\t// Set column widths\n\t\tvar cols = _createNode( rels, 'cols' );\n\t\t$('worksheet', rels).prepend( cols );\n\n\t\tfor ( var i=0, ien=data.header.length ; i<ien ; i++ ) {\n\t\t\tcols.appendChild( _createNode( rels, 'col', {\n\t\t\t\tattr: {\n\t\t\t\t\tmin: i+1,\n\t\t\t\t\tmax: i+1,\n\t\t\t\t\twidth: _excelColWidth( data, i ),\n\t\t\t\t\tcustomWidth: 1\n\t\t\t\t}\n\t\t\t} ) );\n\t\t}\n\n\t\t// Let the developer customise the document if they want to\n\t\tif ( config.customize ) {\n\t\t\tconfig.customize( xlsx );\n\t\t}\n\n\t\t_xlsxToStrings( xlsx );\n\n\t\tflash.setAction( 'excel' );\n\t\tflash.setFileName( exportInfo.filename );\n\t\tflash.setSheetData( xlsx );\n\t\t_setText( flash, '' );\n\n\t\tthis.processing( false );\n\t},\n\n\textension: '.xlsx',\n\t\n\tcreateEmptyCells: false\n} );\n\n\n\n// PDF export\nDataTable.ext.buttons.pdfFlash = $.extend( {}, flashButton, {\n\tclassName: 'buttons-pdf buttons-flash',\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.pdf', 'PDF' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\tthis.processing( true );\n\n\t\t// Set the text\n\t\tvar flash = config._flash;\n\t\tvar data = dt.buttons.exportData( config.exportOptions );\n\t\tvar info = dt.buttons.exportInfo( config );\n\t\tvar totalWidth = dt.table().node().offsetWidth;\n\n\t\t// Calculate the column width ratios for layout of the table in the PDF\n\t\tvar ratios = dt.columns( config.columns ).indexes().map( function ( idx ) {\n\t\t\treturn dt.column( idx ).header().offsetWidth / totalWidth;\n\t\t} );\n\n\t\tflash.setAction( 'pdf' );\n\t\tflash.setFileName( info.filename );\n\n\t\t_setText( flash, JSON.stringify( {\n\t\t\ttitle:         info.title || '',\n\t\t\tmessageTop:    info.messageTop || '',\n\t\t\tmessageBottom: info.messageBottom || '',\n\t\t\tcolWidth:      ratios.toArray(),\n\t\t\torientation:   config.orientation,\n\t\t\tsize:          config.pageSize,\n\t\t\theader:        config.header ? data.header : null,\n\t\t\tfooter:        config.footer ? data.footer : null,\n\t\t\tbody:          data.body\n\t\t} ) );\n\n\t\tthis.processing( false );\n\t},\n\n\textension: '.pdf',\n\n\torientation: 'portrait',\n\n\tpageSize: 'A4',\n\n\tnewline: '\\n'\n} );\n\n\nreturn DataTable.Buttons;\n}));\n"],"file":"buttons.flash.min.js"}